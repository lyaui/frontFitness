{"remainingRequest":"/Users/huangpei-yu/Front-Gym/node_modules/thread-loader/dist/cjs.js!/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js!/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangpei-yu/Front-Gym/src/views/backend/Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangpei-yu/Front-Gym/src/views/backend/Profile.vue","mtime":1584965834610},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _defineProperty from \"/Users/huangpei-yu/Front-Gym/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { required, url } from 'vuelidate/lib/validators';\nimport moment from 'moment';\nexport default {\n  name: 'Profile',\n  data: function data() {\n    return {\n      showDetail: false,\n      account: null,\n      updatePhoto: false\n    };\n  },\n  validations: {\n    account: {\n      name: {\n        required: required\n      },\n      userImg: {\n        required: required,\n        url: url\n      }\n    }\n  },\n  computed: {\n    isLoading: function isLoading() {\n      return this.$store.state.isLoading;\n    },\n    user: function user() {\n      return this.$store.state.auth.user.profile;\n    },\n    payments: function payments() {\n      var _this = this;\n\n      return this.$store.state.checkout.payments.filter(function (payment) {\n        return payment.user.userId === _this.user.userId;\n      });\n    },\n    getDownloadURL: function getDownloadURL() {\n      return this.$store.state.downloadURL;\n    }\n  },\n  watch: {\n    getDownloadURL: function getDownloadURL() {\n      if (this.getDownloadURL) {\n        this.account.userImg = this.getDownloadURL;\n        this.updatePhoto = false;\n      }\n    }\n  },\n  methods: {\n    time: function time(num) {\n      return moment(num).format('YYYY/MM/DD HH:mm');\n    },\n    // 上傳圖片\n    uploadImage: function uploadImage(e) {\n      var file = e.target.files[0];\n\n      if (!file.type.includes('image')) {\n        this.$toasted.error('請上傳圖片檔案', {\n          duration: 3000\n        });\n      } else {\n        this.updatePhoto = true;\n        this.$store.dispatch('updateFile', {\n          file: file,\n          place: 'profile/'\n        });\n      }\n    },\n    // 更新個人檔案\n    updateUser: function updateUser() {\n      var _this2 = this;\n\n      this.$v.$touch();\n\n      if (!this.updatePhoto) {\n        if (this.$v.$invalid) {\n          this.$toasted.error('請正確填寫必要資訊', {\n            duration: 3000\n          });\n        } else {\n          this.$store.dispatch('auth/updateUser', {\n            id: this.user.userId,\n            user: this.account\n          }).then(function () {\n            _this2.$toasted.success('更新成功!!', {\n              duration: 2000\n            });\n          });\n        }\n      }\n    },\n    // show accordion\n    show: function show(i) {\n      this.showDetail = this.showDetail === i ? false : i;\n    },\n    // 前往結帳\n    goCheckout: function goCheckout(id) {\n      this.$router.push(\"/checkout/\".concat(id));\n    }\n  },\n  created: function created() {\n    this.$store.commit('setDownloadUrl', null);\n    this.$store.dispatch('checkout/getPayments');\n    this.account = _objectSpread({}, this.user);\n  }\n};",{"version":3,"sources":["Profile.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <loading\n      :active.sync=\"isLoading\"\n      :opacity=\"0.8\"\n      :background-color=\"'#000'\"\n      :color=\"'#ff5722'\"\n    ></loading>\n\n    <h2 class=\"heading-secondary\">個人資訊</h2>\n    <div class=\"admin-panel mb-md\">\n      <div class=\"heading-tertiary--dark mb-sm\">\n        <i class=\"fas fa-cog\"></i>帳號設定\n      </div>\n      <p class=\"mb-sm\">\n        請確認姓名、電子郵件、圖片是否已設定好，如已設定完成，務必確認上述資訊為最新資訊。\n        （\n        <span class=\"text-highlight\">*</span> 為必填欄位）\n      </p>\n      <div class=\"profile-admin__form\">\n        <div class=\"profile-admin__img\">\n          <div class=\"form__group\">\n            <label class=\"form__label\">\n              個人檔案圖片\n              <span class=\"text-highlight\">*</span>\n            </label>\n            <img v-if=\"account.userImg\" class :src=\"account.userImg\" alt />\n            <img\n              v-if=\"!account.userImg\"\n              src=\"https://png2.pngtree.com/svg/20161215/9bc7bae28b.png\"\n            />\n          </div>\n        </div>\n        <!-- 個人檔案編輯 -->\n        <div class=\"profile-admin__info\">\n          <div class=\"form__row\">\n            <div class=\"form__group\">\n              <label class=\"form__label\">\n                姓名\n                <span class=\"text-highlight\">*</span>\n              </label>\n              <input\n                class=\"form__input\"\n                placeholder=\"請填入姓名\"\n                v-model=\"account.name\"\n              />\n              <template v-if=\"$v.account.name.$dirty\">\n                <span v-if=\"!$v.account.name.required\" class=\"text-warning\"\n                  >姓名為必填欄位</span\n                >\n              </template>\n            </div>\n            <div class=\"form__group\">\n              <label class=\"form__label\">\n                電子信箱（不可變更）\n                <span class=\"text-highlight\">*</span>\n              </label>\n              <input class=\"form__input\" v-model=\"account.email\" disabled />\n            </div>\n          </div>\n          <div class=\"form__row\">\n            <div class=\"form__group\">\n              <label class=\"form__label\" for>輸入圖片網址</label>\n              <input\n                class=\"form__input\"\n                placeholder=\"https://unsplash...\"\n                type=\"text\"\n                v-model=\"account.userImg\"\n              />\n              <template v-if=\"$v.account.userImg.$dirty\">\n                <span v-if=\"!$v.account.userImg.required\" class=\"text-warning\"\n                  >圖片網址為必填欄位</span\n                >\n                <span v-if=\"!$v.account.userImg.url\" class=\"text-warning\"\n                  >請輸入正確格式網址</span\n                >\n              </template>\n            </div>\n            <div class=\"form__group\">\n              <label class=\"form__label\">\n                或 選擇封面檔案\n                <i class=\"fas fa-spinner fa-spin\" v-if=\"updatePhoto\"></i>\n              </label>\n              <input class=\"form__input\" type=\"file\" @change=\"uploadImage\" />\n            </div>\n          </div>\n          <div class=\"btn-footer\">\n            <button\n              style=\"width:120px\"\n              class=\"btn btn-primary\"\n              @click=\"updateUser\"\n            >\n              修改\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 訂單 -->\n    <div class=\"admin-panel mb-md\">\n      <div class=\"heading-tertiary--dark mb-sm\">\n        <i class=\"fas fa-file-invoice-dollar\"></i> 訂單紀錄\n      </div>\n      <p class=\"mb-md\">\n        商品進入購物車並填寫完購買資訊以後，該筆訂單即成立，這裡您可以查看所有訂單詳細資訊，掌握每一筆交易狀況。\n      </p>\n\n      <div v-if=\"payments.length === 0\" class=\"heading-tertiary--grey\">\n        尚無訂單：）\n      </div>\n\n      <div\n        v-else\n        v-for=\"(payment, i) in payments\"\n        :key=\"payment.id\"\n        class=\"mb-md\"\n      >\n        <div class=\"go-checkout d-flex\">\n          <p class=\"heading-tertiary--grey mb-sm\">訂單編號：{{ payment.id }}</p>\n          <button\n            v-if=\"payment.status === '尚未付款'\"\n            @click.prevent=\"goCheckout(payment.id)\"\n            class=\"btn btn-primary mb-sm\"\n            style=\"width:120px\"\n          >\n            確認付款\n          </button>\n        </div>\n\n        <div\n          class=\"admin-order\"\n          :class=\"{ 'admin-order--notpay': payment.status === '尚未付款' }\"\n        >\n          <div class=\"d-flex admin-order-info\">\n            <div style=\"margin-right:3rem\">\n              <p>訂單成立： {{ time(payment.createdAt) }}</p>\n              <p>\n                付款時間：\n                <template v-if=\"payment.status === '付款完成'\">{{\n                  time(payment.finishedAt)\n                }}</template>\n                <template v-else>\n                  <i\n                    class=\"fas fa-exclamation-triangle\"\n                    style=\"color:#ff5721;margin-right:5px\"\n                  ></i\n                  >尚未付款\n                </template>\n              </p>\n            </div>\n            <div>\n              <p>實付金額：{{ payment.total.totalPrice | currency }}</p>\n              <p>付款方式：{{ payment.user.payWay }}</p>\n            </div>\n          </div>\n          <button class=\"btn detail-show-btn mt-sm\" @click=\"show(i)\">\n            <template v-if=\"showDetail === i\">\n              <i class=\"fas fa-chevron-up\"></i> 收合內容\n            </template>\n            <template v-else>\n              <i class=\"fas fa-chevron-down\"></i> 查看詳細\n            </template>\n          </button>\n          <!-- 購買明細 -->\n          <transition name=\"fade\">\n            <div class=\"d-none-phone\" v-if=\"showDetail === i\">\n              <p>價格明細：</p>\n              <table class=\"checkout-table\">\n                <thead>\n                  <tr>\n                    <th>課程名稱</th>\n                    <th>購買方案</th>\n                    <th>原價</th>\n                    <th>售價</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr v-for=\"course in payment.courses\" :key=\"course.title\">\n                    <td>{{ course.title }}</td>\n                    <td>{{ course.plan }}</td>\n                    <td style=\"text-align:right\">\n                      {{ course.price | currency }}\n                    </td>\n                    <td style=\"text-align:right\">\n                      {{ course.sellingPrice | currency }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n              <div class=\"checkout-payment__total\">\n                實付金額：\n                <b class=\"ml-sm\">{{ payment.total.totalPrice | currency }}</b>\n              </div>\n            </div>\n          </transition>\n          <!-- 購買明細mobile -->\n          <transition name=\"fade\">\n            <div class=\"d-block-phone\" v-if=\"showDetail === i\">\n              <p>價格明細：</p>\n              <table\n                class=\"checkout-table\"\n                v-for=\"course in payment.courses\"\n                :key=\"course.title\"\n              >\n                <tbody>\n                  <tr>\n                    <td>\n                      <b>課程名稱</b>\n                    </td>\n                    <td>{{ course.title }}</td>\n                  </tr>\n                  <tr>\n                    <td>\n                      <b>購買方案</b>\n                    </td>\n                    <td>{{ course.plan }}</td>\n                  </tr>\n                  <tr>\n                    <td>\n                      <b>原價</b>\n                    </td>\n                    <td>{{ course.price | currency }}</td>\n                  </tr>\n                  <tr>\n                    <td>\n                      <b>售價</b>\n                    </td>\n                    <td>{{ course.sellingPrice | currency }}</td>\n                  </tr>\n                </tbody>\n              </table>\n              <div class=\"checkout-payment__total\">\n                實付金額：\n                <b class=\"ml-sm\">{{ payment.total.totalPrice | currency }}</b>\n              </div>\n            </div>\n          </transition>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { required, url } from 'vuelidate/lib/validators';\nimport moment from 'moment';\n\nexport default {\n  name: 'Profile',\n  data() {\n    return {\n      showDetail: false,\n      account: null,\n      updatePhoto: false,\n    };\n  },\n  validations: {\n    account: {\n      name: { required },\n      userImg: { required, url },\n    },\n  },\n  computed: {\n    isLoading() {\n      return this.$store.state.isLoading;\n    },\n    user() {\n      return this.$store.state.auth.user.profile;\n    },\n    payments() {\n      return this.$store.state.checkout.payments.filter(\n        (payment) => payment.user.userId === this.user.userId,\n      );\n    },\n    getDownloadURL() {\n      return this.$store.state.downloadURL;\n    },\n  },\n  watch: {\n    getDownloadURL() {\n      if (this.getDownloadURL) {\n        this.account.userImg = this.getDownloadURL;\n        this.updatePhoto = false;\n      }\n    },\n  },\n  methods: {\n    time(num) {\n      return moment(num).format('YYYY/MM/DD HH:mm');\n    },\n\n    // 上傳圖片\n    uploadImage(e) {\n      const file = e.target.files[0];\n      if (!file.type.includes('image')) {\n        this.$toasted.error('請上傳圖片檔案', { duration: 3000 });\n      } else {\n        this.updatePhoto = true;\n        this.$store.dispatch('updateFile', { file, place: 'profile/' });\n      }\n    },\n\n    // 更新個人檔案\n    updateUser() {\n      this.$v.$touch();\n      if (!this.updatePhoto) {\n        if (this.$v.$invalid) {\n          this.$toasted.error('請正確填寫必要資訊', { duration: 3000 });\n        } else {\n          this.$store\n            .dispatch('auth/updateUser', {\n              id: this.user.userId,\n              user: this.account,\n            })\n            .then(() => {\n              this.$toasted.success('更新成功!!', {\n                duration: 2000,\n              });\n            });\n        }\n      }\n    },\n\n    // show accordion\n    show(i) {\n      this.showDetail = this.showDetail === i ? false : i;\n    },\n\n    // 前往結帳\n    goCheckout(id) {\n      this.$router.push(`/checkout/${id}`);\n    },\n  },\n  created() {\n    this.$store.commit('setDownloadUrl', null);\n    this.$store.dispatch('checkout/getPayments');\n    this.account = { ...this.user };\n  },\n};\n</script>\n"],"sourceRoot":"src/views/backend"}]}