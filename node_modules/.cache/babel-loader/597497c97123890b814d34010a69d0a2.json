{"remainingRequest":"/Users/huangpei-yu/Front-Gym/node_modules/thread-loader/dist/cjs.js!/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js!/Users/huangpei-yu/Front-Gym/src/store/auth.js","dependencies":[{"path":"/Users/huangpei-yu/Front-Gym/src/store/auth.js","mtime":1584956502209},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport { db } from '@/firebase/init';\nimport fb from 'firebase/app';\nimport 'firebase/auth';\nexport default {\n  namespaced: true,\n  state: function state() {\n    return {\n      user: null\n    };\n  },\n  getters: {\n    isAuthenticated: function isAuthenticated(state) {\n      return state.user;\n    }\n  },\n  actions: {\n    // 註冊\n    signUp: function signUp(_, _ref) {\n      var email = _ref.email,\n          password = _ref.password;\n      return fb.auth().createUserWithEmailAndPassword(email, password).then(function (_ref2) {\n        var user = _ref2.user;\n        return user;\n      }).catch(function (error) {\n        var message;\n\n        switch (error.code) {\n          case 'auth/email-already-in-use':\n            message = '帳號已存在 請嘗試其他電子信箱';\n            break;\n\n          case 'auth/invalid-email':\n            message = '不符規定的格式 請嘗試其他電子信箱';\n            break;\n\n          case 'auth/weak-password':\n            message = '密碼強度太弱 請嘗試新的密碼組合';\n            break;\n\n          default:\n            message = '註冊失敗 請重新嘗試';\n        }\n\n        return Promise.reject(message);\n      });\n    },\n    // 登入\n    signIn: function signIn(_, _ref3) {\n      var email = _ref3.email,\n          password = _ref3.password;\n      return fb.auth().signInWithEmailAndPassword(email, password).catch(function (error) {\n        var message = error.code === 'auth/user-not-found' ? '無使用者 請再確認帳號' : '密碼錯誤 請再重試';\n        return Promise.reject(message);\n      });\n    },\n    // 登出\n    signOut: function signOut(_ref4) {\n      var commit = _ref4.commit;\n      return fb.auth().signOut().then(function () {\n        return commit('setAuthUser', null);\n      });\n    },\n    // 建立使用者資料\n    createUserProfile: function createUserProfile(_, _ref5) {\n      var uid = _ref5.uid,\n          userProfile = _ref5.userProfile;\n      return db.collection('users').doc(uid).set(userProfile);\n    },\n    // 讀取寫入使用者資料\n    storeAuthUser: function storeAuthUser(_ref6, user) {\n      var commit = _ref6.commit;\n      return db.collection('users').doc(user.uid).get().then(function (snapshot) {\n        var profile = snapshot.data();\n        user.profile = profile;\n        commit('setAuthUser', user);\n        return profile;\n      });\n    },\n    // 更新使用者資料\n    updateUser: function updateUser(_ref7, _ref8) {\n      var commit = _ref7.commit;\n      var id = _ref8.id,\n          user = _ref8.user;\n\n      if (user && id) {\n        db.collection('users').doc(id).update(user).then(function () {\n          commit('changeUserView', user);\n        });\n      }\n    }\n  },\n  mutations: {\n    setAuthUser: function setAuthUser(state, user) {\n      state.user = user;\n    },\n    changeUserView: function changeUserView(state, user) {\n      state.user.profile.name = user.name;\n      state.user.profile.userImg = user.userImg;\n    }\n  }\n};",{"version":3,"sources":["/Users/huangpei-yu/Front-Gym/src/store/auth.js"],"names":["db","fb","namespaced","state","user","getters","isAuthenticated","actions","signUp","_","email","password","auth","createUserWithEmailAndPassword","then","catch","error","message","code","Promise","reject","signIn","signInWithEmailAndPassword","signOut","commit","createUserProfile","uid","userProfile","collection","doc","set","storeAuthUser","get","snapshot","profile","data","updateUser","id","update","mutations","setAuthUser","changeUserView","name","userImg"],"mappings":";AAAA,SACEA,EADF,QAEO,iBAFP;AAGA,OAAOC,EAAP,MAAe,cAAf;AACA,OAAO,eAAP;AAGA,eAAe;AACbC,EAAAA,UAAU,EAAE,IADC;AAEbC,EAAAA,KAFa,mBAEL;AACN,WAAO;AACLC,MAAAA,IAAI,EAAE;AADD,KAAP;AAGD,GANY;AAObC,EAAAA,OAAO,EAAE;AACPC,IAAAA,eADO,2BACSH,KADT,EACgB;AACrB,aAAOA,KAAK,CAACC,IAAb;AACD;AAHM,GAPI;AAabG,EAAAA,OAAO,EAAE;AACP;AACAC,IAAAA,MAFO,kBAEAC,CAFA,QAKJ;AAAA,UAFDC,KAEC,QAFDA,KAEC;AAAA,UADDC,QACC,QADDA,QACC;AACD,aAAOV,EAAE,CAACW,IAAH,GAAUC,8BAAV,CAAyCH,KAAzC,EAAgDC,QAAhD,EACJG,IADI,CACC;AAAA,YACJV,IADI,SACJA,IADI;AAAA,eAEAA,IAFA;AAAA,OADD,EAGOW,KAHP,CAGa,UAACC,KAAD,EAAW;AAC3B,YAAIC,OAAJ;;AACA,gBAAQD,KAAK,CAACE,IAAd;AACE,eAAK,2BAAL;AACED,YAAAA,OAAO,GAAG,iBAAV;AACA;;AACF,eAAK,oBAAL;AACEA,YAAAA,OAAO,GAAG,mBAAV;AACA;;AACF,eAAK,oBAAL;AACEA,YAAAA,OAAO,GAAG,kBAAV;AACA;;AACF;AACEA,YAAAA,OAAO,GAAG,YAAV;AAXJ;;AAaA,eAAOE,OAAO,CAACC,MAAR,CAAeH,OAAf,CAAP;AACD,OAnBI,CAAP;AAoBD,KA1BM;AA4BP;AACAI,IAAAA,MA7BO,kBA6BAZ,CA7BA,SAgCJ;AAAA,UAFDC,KAEC,SAFDA,KAEC;AAAA,UADDC,QACC,SADDA,QACC;AACD,aAAOV,EAAE,CAACW,IAAH,GAAUU,0BAAV,CAAqCZ,KAArC,EAA4CC,QAA5C,EACJI,KADI,CACE,UAACC,KAAD,EAAW;AAChB,YAAMC,OAAO,GAAGD,KAAK,CAACE,IAAN,KAAe,qBAAf,GACZ,aADY,GAEZ,WAFJ;AAGA,eAAOC,OAAO,CAACC,MAAR,CAAeH,OAAf,CAAP;AACD,OANI,CAAP;AAOD,KAxCM;AA0CP;AACAM,IAAAA,OA3CO,0BA6CJ;AAAA,UADDC,MACC,SADDA,MACC;AACD,aAAOvB,EAAE,CAACW,IAAH,GAAUW,OAAV,GACJT,IADI,CACC;AAAA,eAAMU,MAAM,CAAC,aAAD,EAAgB,IAAhB,CAAZ;AAAA,OADD,CAAP;AAED,KAhDM;AAkDP;AACAC,IAAAA,iBAnDO,6BAmDWhB,CAnDX,SAsDJ;AAAA,UAFDiB,GAEC,SAFDA,GAEC;AAAA,UADDC,WACC,SADDA,WACC;AACD,aAAO3B,EAAE,CACN4B,UADI,CACO,OADP,EAEJC,GAFI,CAEAH,GAFA,EAGJI,GAHI,CAGAH,WAHA,CAAP;AAID,KA3DM;AA6DP;AACAI,IAAAA,aA9DO,gCAgEJ3B,IAhEI,EAgEE;AAAA,UADPoB,MACO,SADPA,MACO;AACP,aAAOxB,EAAE,CAAC4B,UAAH,CAAc,OAAd,EACJC,GADI,CACAzB,IAAI,CAACsB,GADL,EAEJM,GAFI,GAGJlB,IAHI,CAGC,UAACmB,QAAD,EAAc;AAClB,YAAMC,OAAO,GAAGD,QAAQ,CAACE,IAAT,EAAhB;AACA/B,QAAAA,IAAI,CAAC8B,OAAL,GAAeA,OAAf;AACAV,QAAAA,MAAM,CAAC,aAAD,EAAgBpB,IAAhB,CAAN;AACA,eAAO8B,OAAP;AACD,OARI,CAAP;AASD,KA1EM;AA4EP;AACAE,IAAAA,UA7EO,oCAkFJ;AAAA,UAJDZ,MAIC,SAJDA,MAIC;AAAA,UAFDa,EAEC,SAFDA,EAEC;AAAA,UADDjC,IACC,SADDA,IACC;;AACD,UAAIA,IAAI,IAAIiC,EAAZ,EAAgB;AACdrC,QAAAA,EAAE,CAAC4B,UAAH,CAAc,OAAd,EACGC,GADH,CACOQ,EADP,EAEGC,MAFH,CAEUlC,IAFV,EAGGU,IAHH,CAGQ,YAAM;AACVU,UAAAA,MAAM,CAAC,gBAAD,EAAmBpB,IAAnB,CAAN;AACD,SALH;AAMD;AACF;AA3FM,GAbI;AA2GbmC,EAAAA,SAAS,EAAE;AACTC,IAAAA,WADS,uBACGrC,KADH,EACUC,IADV,EACgB;AACvBD,MAAAA,KAAK,CAACC,IAAN,GAAaA,IAAb;AACD,KAHQ;AAKTqC,IAAAA,cALS,0BAKMtC,KALN,EAKaC,IALb,EAKmB;AAC1BD,MAAAA,KAAK,CAACC,IAAN,CAAW8B,OAAX,CAAmBQ,IAAnB,GAA0BtC,IAAI,CAACsC,IAA/B;AACAvC,MAAAA,KAAK,CAACC,IAAN,CAAW8B,OAAX,CAAmBS,OAAnB,GAA6BvC,IAAI,CAACuC,OAAlC;AACD;AARQ;AA3GE,CAAf","sourcesContent":["import {\n  db,\n} from '@/firebase/init';\nimport fb from 'firebase/app';\nimport 'firebase/auth';\n\n\nexport default {\n  namespaced: true,\n  state() {\n    return {\n      user: null,\n    };\n  },\n  getters: {\n    isAuthenticated(state) {\n      return state.user;\n    },\n  },\n\n  actions: {\n    // 註冊\n    signUp(_, {\n      email,\n      password,\n    }) {\n      return fb.auth().createUserWithEmailAndPassword(email, password)\n        .then(({\n          user,\n        }) => user).catch((error) => {\n          let message;\n          switch (error.code) {\n            case 'auth/email-already-in-use':\n              message = '帳號已存在 請嘗試其他電子信箱';\n              break;\n            case 'auth/invalid-email':\n              message = '不符規定的格式 請嘗試其他電子信箱';\n              break;\n            case 'auth/weak-password':\n              message = '密碼強度太弱 請嘗試新的密碼組合';\n              break;\n            default:\n              message = '註冊失敗 請重新嘗試';\n          }\n          return Promise.reject(message);\n        });\n    },\n\n    // 登入\n    signIn(_, {\n      email,\n      password,\n    }) {\n      return fb.auth().signInWithEmailAndPassword(email, password)\n        .catch((error) => {\n          const message = error.code === 'auth/user-not-found'\n            ? '無使用者 請再確認帳號'\n            : '密碼錯誤 請再重試';\n          return Promise.reject(message);\n        });\n    },\n\n    // 登出\n    signOut({\n      commit,\n    }) {\n      return fb.auth().signOut()\n        .then(() => commit('setAuthUser', null));\n    },\n\n    // 建立使用者資料\n    createUserProfile(_, {\n      uid,\n      userProfile,\n    }) {\n      return db\n        .collection('users')\n        .doc(uid)\n        .set(userProfile);\n    },\n\n    // 讀取寫入使用者資料\n    storeAuthUser({\n      commit,\n    }, user) {\n      return db.collection('users')\n        .doc(user.uid)\n        .get()\n        .then((snapshot) => {\n          const profile = snapshot.data();\n          user.profile = profile;\n          commit('setAuthUser', user);\n          return profile;\n        });\n    },\n\n    // 更新使用者資料\n    updateUser({\n      commit,\n    }, {\n      id,\n      user,\n    }) {\n      if (user && id) {\n        db.collection('users')\n          .doc(id)\n          .update(user)\n          .then(() => {\n            commit('changeUserView', user);\n          });\n      }\n    },\n  },\n\n  mutations: {\n    setAuthUser(state, user) {\n      state.user = user;\n    },\n\n    changeUserView(state, user) {\n      state.user.profile.name = user.name;\n      state.user.profile.userImg = user.userImg;\n    },\n  },\n};\n"]}]}