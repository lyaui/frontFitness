{"remainingRequest":"/Users/huangpei-yu/Front-Gym/node_modules/thread-loader/dist/cjs.js!/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js!/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangpei-yu/Front-Gym/src/views/Courses.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangpei-yu/Front-Gym/src/views/Courses.vue","mtime":1580846315378},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport $ from \"jquery\";\nimport { fb, db } from \"@/firebase/init\";\nimport CourseCard from \"@/components/CourseCard\";\nimport CourseList from \"@/components/CourseList\";\nexport default {\n  components: {\n    CourseCard: CourseCard,\n    CourseList: CourseList\n  },\n  data: function data() {\n    return {\n      priceOrder: true,\n      ratingOrder: true,\n      searchShow: false,\n      searchWord: null,\n      keyWord: null,\n      showNavbar: true,\n      lastScrollPosition: 0,\n      count: 0,\n      infiniteData: [],\n      busy: false,\n      coursesHead: [],\n      courses: [],\n      intro: null,\n      headerIntro: [{\n        course: \"所有課程\",\n        intro: \"最豐富的運動課程，有氧、瑜珈、游泳、飛輪等多元項目給注重健康的你！\"\n      }, {\n        course: \"有氧課程\",\n        intro: \"最多元的有氧課程，放鬆愉快的上課方式，隨著音樂一起動，減脂甩肉好easy！\"\n      }, {\n        course: \"瑜珈課程\",\n        intro: \"OL下班最愛的運動！增強肌力柔軟度、矯正姿態，瘦身舒壓，為妳找回沉靜心靈。\"\n      }, {\n        course: \"游泳課程\",\n        intro: \"專業小班授課，自由式、蛙式、仰式、蝶式手把手教到會，零基礎也能身如蛟龍。\"\n      }, {\n        course: \"飛輪課程\",\n        intro: \"高效燃脂極速飆汗，增強肌力與心肺耐力，忙碌現代人最有效率的減脂方式！\"\n      }, {\n        course: \"其他課程\",\n        intro: \"精選各式特殊運動，重訓、武術、桌球等...這裡通通有！\"\n      }]\n    };\n  },\n  methods: {\n    selectCat: function selectCat(cat) {\n      this.$store.commit(\"selectCat\", cat);\n      this.getCourse();\n    },\n    onScroll: function onScroll() {\n      // Get the current scroll position\n      var currentScrollPosition = window.pageYOffset || document.documentElement.scrollTop; // Because of momentum scrolling on mobiles, we shouldn't continue if it is less than zero\n\n      if (currentScrollPosition < 0) {\n        return;\n      } // Stop executing this function if the difference between\n      // current scroll position and last scroll position is less than some offset\n\n\n      if (Math.abs(currentScrollPosition - this.lastScrollPosition) < 60) {\n        return;\n      }\n\n      this.showNavbar = currentScrollPosition < this.lastScrollPosition;\n      this.lastScrollPosition = currentScrollPosition;\n    },\n    loadMore: function loadMore() {\n      var _this = this;\n\n      var arrayShow = this.courses;\n\n      if (this.infiniteData.length <= arrayShow.length) {\n        this.busy = true;\n        setTimeout(function () {\n          for (var i = 0, j = 5; i < j; i++) {\n            if (_this.count === arrayShow.length) {\n              break;\n            }\n\n            _this.infiniteData.push(arrayShow[_this.count++]);\n          }\n\n          _this.busy = false;\n        }, 500);\n      }\n    },\n    reset: function reset() {\n      var _this2 = this;\n\n      this.searchShow = false;\n      this.searchWord = null;\n      this.search = [];\n      this.count = 0;\n      this.courses = [];\n      this.coursesHead = [];\n      this.infiniteData = [];\n      this.intro = this.headerIntro.filter(function (item) {\n        return item.course == _this2.$store.state.categorySelected;\n      });\n    },\n    getCourse: function getCourse() {\n      var _this3 = this;\n\n      this.reset(); //避免渲染問題，直接採用不同的方式呼叫資料而非一次全叫再分類\n\n      if (this.$store.state.categorySelected === \"所有課程\") {\n        db.collection(\"courses\").get().then(function (snapshot) {\n          snapshot.forEach(function (doc) {\n            var course = doc.data();\n            course.id = doc.id;\n\n            _this3.courses.push(course);\n          });\n          _this3.coursesHead = _this3.courses.slice(0);\n        });\n      } else {\n        db.collection(\"courses\").where(\"categorySelected\", \"==\", this.$store.state.categorySelected).get().then(function (snapshot) {\n          snapshot.forEach(function (doc) {\n            var course = doc.data();\n            course.id = doc.id;\n\n            _this3.courses.push(course);\n          });\n          _this3.coursesHead = _this3.courses.slice(0);\n        });\n      }\n\n      this.loadMore();\n    },\n    searchCourse: function searchCourse() {\n      var _this4 = this;\n\n      if (this.searchWord) {\n        this.keyWord = this.searchWord;\n        this.reset();\n        this.searchShow = true;\n        db.collection(\"courses\").get().then(function (snapshot) {\n          snapshot.forEach(function (doc) {\n            var course = doc.data();\n            course.id = doc.id;\n\n            _this4.courses.push(course);\n          });\n        }).then(function () {\n          _this4.courses = _this4.courses.filter(function (course) {\n            return course.title.match(_this4.keyWord);\n          }) || [];\n\n          _this4.loadMore();\n        });\n      }\n    },\n    orderCourse: function orderCourse(property, order) {\n      this.courses = order ? this.courses.sort(function (a, b) {\n        return b[property] - a[property];\n      }) : this.courses.sort(function (a, b) {\n        return a[property] - b[property];\n      });\n      this.count = 0;\n      this.infiniteData = [];\n      this.loadMore();\n    }\n  },\n  created: function created() {\n    this.getCourse();\n  },\n  mounted: function mounted() {\n    window.addEventListener(\"scroll\", this.onScroll);\n  },\n  beforeDestroy: function beforeDestroy() {\n    window.removeEventListener(\"scroll\", this.onScroll);\n  }\n};",{"version":3,"sources":["Courses.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <nav class=\"sub-nav\" :class=\"{'sub-nav--hidden': !showNavbar}\">\n      <ul class=\"sub-nav__list\">\n        <li\n          class=\"sub-nav__item\"\n          :class=\"{'sub-nav__item--active':$store.state.categorySelected==='所有課程'}\"\n          @click.prevent=\"selectCat('所有課程');\"\n        >\n          <a class=\"sub-nav__link\">\n            <i class=\"fas fa-th-large\"></i>\n            <p>所有課程</p>\n          </a>\n        </li>\n        <li\n          class=\"sub-nav__item\"\n          :class=\"{'sub-nav__item--active':$store.state.categorySelected==='有氧課程'}\"\n          @click.prevent=\"selectCat('有氧課程');\"\n        >\n          <a class=\"sub-nav__link\">\n            <i class=\"fas fa-bowling-ball\"></i>\n            <p>有氧課程</p>\n          </a>\n        </li>\n        <li\n          class=\"sub-nav__item\"\n          :class=\"{'sub-nav__item--active':$store.state.categorySelected==='瑜珈課程'}\"\n          @click.prevent=\"selectCat('瑜珈課程');\"\n        >\n          <a class=\"sub-nav__link\">\n            <i class=\"fas fa-pray\"></i>\n            <p>瑜珈課程</p>\n          </a>\n        </li>\n        <li\n          class=\"sub-nav__item\"\n          :class=\"{'sub-nav__item--active':$store.state.categorySelected==='游泳課程'}\"\n          @click.prevent=\"selectCat('游泳課程');\"\n        >\n          <a class=\"sub-nav__link\">\n            <i class=\"fas fa-swimmer\"></i>\n            <p>游泳課程</p>\n          </a>\n        </li>\n        <li\n          class=\"sub-nav__item\"\n          :class=\"{'sub-nav__item--active':$store.state.categorySelected==='飛輪課程'}\"\n          @click.prevent=\"selectCat('飛輪課程');\"\n        >\n          <a class=\"sub-nav__link\">\n            <i class=\"fas fa-bicycle\"></i>\n            <p>飛輪課程</p>\n          </a>\n        </li>\n        <li\n          class=\"sub-nav__item\"\n          :class=\"{'sub-nav__item--active':$store.state.categorySelected==='其他課程'}\"\n          @click.prevent=\"selectCat('其他課程');\"\n        >\n          <a class=\"sub-nav__link\">\n            <i class=\"fas fa-dumbbell\"></i>\n            <p>其他課程</p>\n          </a>\n        </li>\n      </ul>\n    </nav>\n    <main class=\"courses-main\">\n      <header class=\"courses-header\" v-if=\"!searchShow\">\n        <div class=\"container\">\n          <h2 class=\"courses-header__title\">{{intro[0].course}}</h2>\n          <p class=\"courses-header__text\">{{intro[0].intro}}</p>\n        </div>\n      </header>\n      <div class=\"container\">\n        <!-- 精選課程 -->\n        <section v-if=\"!searchShow\">\n          <div class=\"section-title\">\n            <h2 class=\"section-title__name\">精選{{$store.state.categorySelected}}</h2>\n          </div>\n          <course-card :course-card=\"coursesHead\"></course-card>\n        </section>\n        <!-- 全部課程 -->\n        <section>\n          <div class=\"search-result\" v-if=\"searchShow\">\n            <div v-if=\"courses.length===0\">\n              <p>\n                抱歉，我們找不到有關「{{keyWord}}」的任何結果\n                <br>請嘗試調整您的搜索。以下是幾點建議：\n              </p>\n              <ul>\n                <li>確保所有單詞拼寫正確。</li>\n                <li>嘗試不同的搜索詞。</li>\n                <li>嘗試更常見的搜索詞。</li>\n              </ul>\n            </div>\n            <div v-if=\"courses.length>0\">關於「{{keyWord}}」的 {{courses.length}} 筆结果：</div>\n          </div>\n          <div class=\"section-title\" v-if=\"!searchShow\">\n            <h2 class=\"section-title__name\">全部{{$store.state.categorySelected}}</h2>\n          </div>\n          <div class=\"courses-filter\">\n            <div class=\"courses-filter__list\">\n              <div class=\"search\">\n                <input\n                  type=\"text\"\n                  class=\"search__input\"\n                  v-model.trim=\"searchWord\"\n                  placeholder=\"搜尋課程\"\n                  @keyup.enter=\"searchCourse()\"\n                >\n                <button class=\"search__button\" @click=\"searchCourse()\">\n                  <div class=\"search__icon\">\n                    <i class=\"fas fa-search\"></i>\n                  </div>\n                </button>\n              </div>\n\n              <div class=\"courses-filter__btn-group d-flex\">\n                <div class=\"courses-filter__item\">\n                  <button\n                    @click=\"priceOrder=!priceOrder;orderCourse('price',priceOrder)\"\n                    class=\"courses-filter__btn btn\"\n                  >\n                    <i v-if=\"priceOrder\" class=\"fas fa-chevron-down\"></i>\n                    <i v-else class=\"fas fa-chevron-up\"></i>\n                    價格\n                  </button>\n                </div>\n                <div class=\"courses-filter__item\">\n                  <button\n                    @click=\"ratingOrder=!ratingOrder;orderCourse('avgRating',ratingOrder)\"\n                    class=\"courses-filter__btn btn\"\n                  >\n                    <i v-if=\"ratingOrder\" class=\"fas fa-chevron-down\"></i>\n                    <i v-else class=\"fas fa-chevron-up\"></i>\n                    評等\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <course-list :courses-list=\"infiniteData\" v-if=\"infiniteData.length>0\"></course-list>\n          <div\n            class=\"ifinite-scroll\"\n            v-infinite-scroll=\"loadMore\"\n            infinite-scroll-disabled=\"busy\"\n            infinite-scroll-distance=\"15\"\n            infinite-scroll-immediate-check=\"false\"\n          >\n            <i v-if=\"busy\" class=\"fas fa-spinner fa-spin\"></i>\n          </div>\n        </section>\n      </div>\n    </main>\n    <add-to-cart-modal></add-to-cart-modal>\n  </div>\n</template>\n\n<script>\nimport $ from \"jquery\";\nimport { fb, db } from \"@/firebase/init\";\nimport CourseCard from \"@/components/CourseCard\";\nimport CourseList from \"@/components/CourseList\";\n\nexport default {\n  components: {\n    CourseCard,\n    CourseList\n  },\n  data() {\n    return {\n      priceOrder: true,\n      ratingOrder: true,\n      searchShow: false,\n      searchWord: null,\n      keyWord: null,\n      showNavbar: true,\n      lastScrollPosition: 0,\n      count: 0,\n      infiniteData: [],\n      busy: false,\n      coursesHead: [],\n      courses: [],\n      intro: null,\n      headerIntro: [\n        {\n          course: \"所有課程\",\n          intro:\n            \"最豐富的運動課程，有氧、瑜珈、游泳、飛輪等多元項目給注重健康的你！\"\n        },\n        {\n          course: \"有氧課程\",\n          intro:\n            \"最多元的有氧課程，放鬆愉快的上課方式，隨著音樂一起動，減脂甩肉好easy！\"\n        },\n        {\n          course: \"瑜珈課程\",\n          intro:\n            \"OL下班最愛的運動！增強肌力柔軟度、矯正姿態，瘦身舒壓，為妳找回沉靜心靈。\"\n        },\n\n        {\n          course: \"游泳課程\",\n          intro:\n            \"專業小班授課，自由式、蛙式、仰式、蝶式手把手教到會，零基礎也能身如蛟龍。\"\n        },\n        {\n          course: \"飛輪課程\",\n          intro:\n            \"高效燃脂極速飆汗，增強肌力與心肺耐力，忙碌現代人最有效率的減脂方式！\"\n        },\n        {\n          course: \"其他課程\",\n          intro: \"精選各式特殊運動，重訓、武術、桌球等...這裡通通有！\"\n        }\n      ]\n    };\n  },\n\n  methods: {\n    selectCat(cat) {\n      this.$store.commit(\"selectCat\", cat);\n      this.getCourse();\n    },\n    onScroll() {\n      // Get the current scroll position\n      const currentScrollPosition =\n        window.pageYOffset || document.documentElement.scrollTop;\n      // Because of momentum scrolling on mobiles, we shouldn't continue if it is less than zero\n      if (currentScrollPosition < 0) {\n        return;\n      }\n      // Stop executing this function if the difference between\n      // current scroll position and last scroll position is less than some offset\n      if (Math.abs(currentScrollPosition - this.lastScrollPosition) < 60) {\n        return;\n      }\n      this.showNavbar = currentScrollPosition < this.lastScrollPosition;\n      this.lastScrollPosition = currentScrollPosition;\n    },\n    loadMore() {\n      let arrayShow = this.courses;\n      if (this.infiniteData.length <= arrayShow.length) {\n        this.busy = true;\n\n        setTimeout(() => {\n          for (var i = 0, j = 5; i < j; i++) {\n            if (this.count === arrayShow.length) {\n              break;\n            }\n            this.infiniteData.push(arrayShow[this.count++]);\n          }\n          this.busy = false;\n        }, 500);\n      }\n    },\n    reset() {\n      this.searchShow = false;\n      this.searchWord = null;\n      this.search = [];\n      this.count = 0;\n      this.courses = [];\n      this.coursesHead = [];\n      this.infiniteData = [];\n      this.intro = this.headerIntro.filter(\n        item => item.course == this.$store.state.categorySelected\n      );\n    },\n    getCourse() {\n      this.reset();\n      //避免渲染問題，直接採用不同的方式呼叫資料而非一次全叫再分類\n      if (this.$store.state.categorySelected === \"所有課程\") {\n        db.collection(\"courses\")\n          .get()\n          .then(snapshot => {\n            snapshot.forEach(doc => {\n              let course = doc.data();\n              course.id = doc.id;\n              this.courses.push(course);\n            });\n            this.coursesHead = this.courses.slice(0);\n          });\n      } else {\n        db.collection(\"courses\")\n          .where(\"categorySelected\", \"==\", this.$store.state.categorySelected)\n          .get()\n          .then(snapshot => {\n            snapshot.forEach(doc => {\n              let course = doc.data();\n              course.id = doc.id;\n              this.courses.push(course);\n            });\n            this.coursesHead = this.courses.slice(0);\n          });\n      }\n      this.loadMore();\n    },\n    searchCourse() {\n      if (this.searchWord) {\n        this.keyWord = this.searchWord;\n        this.reset();\n        this.searchShow = true;\n        db.collection(\"courses\")\n          .get()\n          .then(snapshot => {\n            snapshot.forEach(doc => {\n              let course = doc.data();\n              course.id = doc.id;\n              this.courses.push(course);\n            });\n          })\n          .then(() => {\n            this.courses =\n              this.courses.filter(course => course.title.match(this.keyWord)) ||\n              [];\n            this.loadMore();\n          });\n      }\n    },\n    orderCourse(property, order) {\n      this.courses = order\n        ? this.courses.sort((a, b) => b[property] - a[property])\n        : this.courses.sort((a, b) => a[property] - b[property]);\n      this.count = 0;\n      this.infiniteData = [];\n      this.loadMore();\n    }\n  },\n  created() {\n    this.getCourse();\n  },\n  mounted() {\n    window.addEventListener(\"scroll\", this.onScroll);\n  },\n  beforeDestroy() {\n    window.removeEventListener(\"scroll\", this.onScroll);\n  }\n};\n</script>"],"sourceRoot":"src/views"}]}