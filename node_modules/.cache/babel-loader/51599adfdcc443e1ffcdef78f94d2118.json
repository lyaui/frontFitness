{"remainingRequest":"/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js!/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangpei-yu/Front-Gym/src/views/backend/CourseNewEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangpei-yu/Front-Gym/src/views/backend/CourseNewEdit.vue","mtime":1584965747020},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport _defineProperty from \"/Users/huangpei-yu/Front-Gym/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { required, maxLength, minValue, url } from 'vuelidate/lib/validators';\nimport { VueEditor } from 'vue2-editor';\nexport default {\n  name: 'CourseNewEdit',\n  components: {\n    VueEditor: VueEditor\n  },\n  data: function data() {\n    return {\n      prevRoute: false,\n      updateCover: false,\n      week: ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期日'],\n      category: ['有氧課程', '瑜珈課程', '游泳課程', '飛輪課程', '其他課程'],\n      coaches: ['Amy珊珊', 'CICI', 'Danny', 'Papaya', 'Peco', 'Ryan', '小惠', '張三豐', '強森', '海德', '阿Ni', '阿壯'],\n      courseNew: {\n        title: '',\n        intro: '',\n        tags: [],\n        categorySelected: '',\n        coach: '',\n        week: '',\n        time: '',\n        quantity: null,\n        remainQuantity: null,\n        originPrice: null,\n        price: null,\n        discount: false,\n        imageUrl: '',\n        avgRating: 0\n      },\n      course: null,\n      tag: null,\n      modal: null,\n      titleMax: 25,\n      introMax: 80\n    };\n  },\n  validations: {\n    course: {\n      title: {\n        required: required,\n        maxLength: maxLength(24)\n      },\n      intro: {\n        required: required,\n        maxLength: maxLength(79)\n      },\n      categorySelected: {\n        required: required\n      },\n      coach: {\n        required: required\n      },\n      week: {\n        required: required\n      },\n      time: {\n        required: required\n      },\n      originPrice: {\n        required: required,\n        minValue: minValue(0)\n      },\n      price: {\n        required: required,\n        minValue: minValue(0)\n      },\n      quantity: {\n        required: required,\n        minValue: minValue(0)\n      },\n      remainQuantity: {\n        required: required,\n        minValue: minValue(0)\n      },\n      imageUrl: {\n        required: required,\n        url: url\n      }\n    }\n  },\n  computed: {\n    isLoading: function isLoading() {\n      return this.$store.state.isLoading;\n    },\n    status: function status() {\n      return this.$store.state.courses.status;\n    },\n    getCourse: function getCourse() {\n      return this.$store.state.courses.course;\n    },\n    getDownloadURL: function getDownloadURL() {\n      return this.$store.state.downloadURL;\n    }\n  },\n  watch: {\n    // 從編輯狀態切到新增狀態的話\n    status: function status() {\n      if (this.status === '新增課程') {\n        this.course = _objectSpread({}, this.courseNew);\n      }\n    },\n    getDownloadURL: function getDownloadURL() {\n      if (this.getDownloadURL) {\n        this.course.imageUrl = this.getDownloadURL;\n        this.updateCover = false;\n      }\n    }\n  },\n  methods: {\n    addCourse: function addCourse() {\n      var _this = this;\n\n      this.$v.$touch();\n\n      if (this.$v.$invalid) {\n        this.$toasted.error('請正確填寫必要資訊', {\n          duration: 3000\n        });\n      } else {\n        this.$store.dispatch('courses/createCourse', _objectSpread({}, this.course)).then(function () {\n          _this.$toasted.success('成功新增課程', {\n            duration: 2000\n          });\n\n          _this.$router.push({\n            name: 'coursesAdmin'\n          });\n        }).catch(function (e) {\n          return console(e.message);\n        });\n      }\n    },\n    updateCourse: function updateCourse(id) {\n      var _this2 = this;\n\n      this.$v.$touch();\n\n      if (!this.updateCover) {\n        if (this.$v.$invalid) {\n          this.$toasted.error('請正確填寫必要資訊', {\n            duration: 3000\n          });\n        } else {\n          this.$store.dispatch('courses/updateCourse', {\n            id: id,\n            course: this.course\n          }).then(function () {\n            _this2.$toasted.success('更新成功!!', {\n              duration: 2000\n            });\n\n            _this2.$router.push({\n              name: 'coursesAdmin'\n            });\n          });\n        }\n      }\n    },\n    addTags: function addTags() {\n      if (this.tag) {\n        this.course.tags.push(this.tag);\n      }\n\n      this.tag = '';\n    },\n    deleteTag: function deleteTag(key) {\n      this.course.tags.splice(key, 1);\n    },\n    uploadImage: function uploadImage(e) {\n      var file = e.target.files[0];\n\n      if (!file.type.includes('image')) {\n        this.$toasted.error('請上傳圖片檔案', {\n          duration: 3000\n        });\n      } else {\n        this.updateCover = true;\n        this.$store.dispatch('updateFile', {\n          file: file,\n          place: 'courses/'\n        });\n      }\n    }\n  },\n  created: function created() {\n    this.$store.commit('setDownloadUrl', null);\n\n    if (this.status === '編輯課程') {\n      this.course = _objectSpread({}, this.getCourse);\n    } else {\n      this.course = _objectSpread({}, this.courseNew);\n    }\n  }\n};",{"version":3,"sources":["CourseNewEdit.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <h2 class=\"heading-secondary\">{{ status }}</h2>\n    <div class=\"admin-panel mb-md\">\n      <form>\n        <div class=\"edit-form\">\n          <!-- 課程封面 -->\n          <div class=\"cover-upload\">\n            <div>\n              <div class=\"form__row\">\n                <div class=\"form__group\">\n                  <label class=\"form__label\">輸入封面網址</label>\n                  <input\n                    class=\"form__input\"\n                    type=\"text\"\n                    placeholder=\"https://unsplash...\"\n                    :class=\"{\n                      'form__input--warning': $v.course.imageUrl.$error,\n                    }\"\n                    v-model=\"course.imageUrl\"\n                  />\n                  <template v-if=\"$v.course.imageUrl.$dirty\">\n                    <span\n                      v-if=\"!$v.course.imageUrl.required\"\n                      class=\"text-warning\"\n                      >封面網址為必填欄位</span\n                    >\n                    <span v-if=\"!$v.course.imageUrl.url\" class=\"text-warning\"\n                      >請輸入正確格式網址</span\n                    >\n                  </template>\n                </div>\n              </div>\n              <div class=\"form__row\">\n                <div class=\"form__group\">\n                  <label class=\"form__label\">\n                    或 選擇封面檔案\n                    <i class=\"fas fa-spinner fa-spin\" v-if=\"updateCover\"></i>\n                  </label>\n                  <input\n                    @change=\"uploadImage\"\n                    class=\"form__input\"\n                    type=\"file\"\n                  />\n                </div>\n              </div>\n            </div>\n            <img\n              v-if=\"!!course.imageUrl\"\n              class=\"form__img\"\n              :src=\"course.imageUrl\"\n            />\n            <img\n              v-else\n              class=\"form__img\"\n              src=\"https://fakeimg.pl/250x150/?retina=1&text=請上傳封面&font=noto\"\n            />\n          </div>\n          <!-- 課程內容 -->\n          <div class=\"content-edit\">\n            <!-- 課程名稱 -->\n            <div class>\n              <div class=\"form__group\">\n                <label class=\"form__label\">課程名稱（標題上限25字元）</label>\n                <input\n                  class=\"form__input\"\n                  placeholder=\"請填入課程名稱\"\n                  type=\"text\"\n                  v-model.trim=\"course.title\"\n                  :maxlength=\"titleMax\"\n                  :class=\"{ 'form__input--warning': $v.course.title.$error }\"\n                />\n                <div class=\"form__counter\">\n                  <span>{{ titleMax - course.title.length }}</span>\n                </div>\n                <template v-if=\"$v.course.title.$dirty\">\n                  <span v-if=\"!$v.course.title.required\" class=\"text-warning\"\n                    >課程名稱為必填欄位</span\n                  >\n                  <span v-if=\"!$v.course.title.maxLength\" class=\"text-warning\"\n                    >超過上限25字元 請刪減標題長度</span\n                  >\n                </template>\n              </div>\n            </div>\n\n            <!-- 課程簡介 -->\n            <div class=\"form__row\">\n              <div class=\"form__group\">\n                <label class=\"form__label\">課程簡介（簡介上限80字元）</label>\n                <input\n                  class=\"form__input\"\n                  placeholder=\"請填入課程簡介\"\n                  type=\"textarea\"\n                  v-model.trim=\"course.intro\"\n                  style=\"padding-right:40px\"\n                  :maxlength=\"introMax\"\n                  :class=\"{ 'form__input--warning': $v.course.intro.$error }\"\n                />\n                <div class=\"form__counter\">\n                  <span>{{ introMax - course.intro.length }}</span>\n                </div>\n                <template v-if=\"$v.course.intro.$dirty\">\n                  <span v-if=\"!$v.course.intro.required\" class=\"text-warning\"\n                    >課程簡介為必填欄位</span\n                  >\n                  <span v-if=\"!$v.course.intro.maxLength\" class=\"text-warning\"\n                    >超過上限80字元 請刪減簡介長度</span\n                  >\n                </template>\n              </div>\n            </div>\n\n            <!-- 課程標籤 -->\n            <div class=\"form__row\">\n              <div class=\"form__group\">\n                <div class=\"form__tag-case\">\n                  <label class=\"form__label\">標籤</label>\n                  <div\n                    class=\"form__tag\"\n                    v-for=\"(tag, key) in course.tags\"\n                    :key=\"key\"\n                  >\n                    {{ tag }}\n                    <i class=\"fas fa-times-circle\" @click=\"deleteTag(key)\"></i>\n                  </div>\n                </div>\n                <input\n                  class=\"form__input\"\n                  type=\"text\"\n                  @keyup.enter=\"addTags()\"\n                  v-model.trim=\"tag\"\n                  placeholder=\"請填入標籤並以enter隔開\"\n                />\n              </div>\n            </div>\n\n            <!-- 課程類別、教練 -->\n            <div class=\"form__row\">\n              <div class=\"form__group\">\n                <label class=\"form__label\">課程類別</label>\n                <select\n                  class=\"form__input\"\n                  v-model=\"course.categorySelected\"\n                  :class=\"{\n                    'form__input--warning': $v.course.categorySelected.$error,\n                  }\"\n                  required\n                >\n                  <option value disabled selected hidden>請選擇課程類別</option>\n                  <option\n                    :value=\"item\"\n                    v-for=\"(item, key) in category\"\n                    :key=\"key\"\n                    >{{ item }}</option\n                  >\n                </select>\n                <template v-if=\"$v.course.categorySelected.$dirty\">\n                  <span\n                    v-if=\"!$v.course.categorySelected.required\"\n                    class=\"text-warning\"\n                    >課程類別為必選欄位</span\n                  >\n                </template>\n              </div>\n              <div class=\"form__group\">\n                <label class=\"form__label\">課程教練</label>\n                <select\n                  class=\"form__input\"\n                  :class=\"{ 'form__input--warning': $v.course.coach.$error }\"\n                  v-model=\"course.coach\"\n                  required\n                >\n                  <option value disabled selected hidden>請選擇課程教練</option>\n                  <option\n                    :value=\"item\"\n                    v-for=\"(item, key) in coaches\"\n                    :key=\"key\"\n                    >{{ item }}</option\n                  >\n                </select>\n                <template v-if=\"$v.course.coach.$dirty\">\n                  <span v-if=\"!$v.course.coach.required\" class=\"text-warning\"\n                    >課程教練為必選欄位</span\n                  >\n                </template>\n              </div>\n            </div>\n\n            <!-- 課程星期、時間 -->\n            <div class=\"form__row\">\n              <div class=\"form__group\">\n                <label class=\"form__label\">課程星期</label>\n                <select\n                  class=\"form__input\"\n                  :class=\"{ 'form__input--warning': $v.course.week.$error }\"\n                  v-model=\"course.week\"\n                  required\n                >\n                  <option value disabled selected hidden>請選擇課程星期</option>\n                  <option v-for=\"day in week\" :key=\"day\">{{ day }}</option>\n                </select>\n                <template v-if=\"$v.course.week.$dirty\">\n                  <span v-if=\"!$v.course.week.required\" class=\"text-warning\"\n                    >課程星期為必選欄位</span\n                  >\n                </template>\n              </div>\n              <div class=\"form__group\">\n                <label class=\"form__label\">課程時間</label>\n                <select\n                  class=\"form__input\"\n                  :class=\"{ 'form__input--warning': $v.course.time.$error }\"\n                  v-model=\"course.time\"\n                  required\n                >\n                  <option value disabled selected hidden>請選擇課程時間</option>\n                  <optgroup label=\"上午\">\n                    <option value=\"上午09:00~10:00\" default selected\n                      >09:00~10:00</option\n                    >\n                    <option value=\"上午10:00~11:00\">10:00~11:00</option>\n                    <option value=\"上午11:00~12:00\">11:00~12:00</option>\n                  </optgroup>\n                  <optgroup label=\"中午\">\n                    <option value=\"中午14:00~15:00\">14:00~15:00</option>\n                    <option value=\"中午15:00~16:00\">15:00~16:00</option>\n                    <option value=\"中午16:00~17:00\">16:00~17:00</option>\n                  </optgroup>\n                  <optgroup label=\"晚上\">\n                    <option value=\"晚上18:00~19:00\">18:00~19:00</option>\n                    <option value=\"晚上19:00~20:00\">19:00~20:00</option>\n                    <option value=\"晚上20:00~21:00\">20:00~21:00</option>\n                  </optgroup>\n                </select>\n                <template v-if=\"$v.course.time.$dirty\">\n                  <span v-if=\"!$v.course.time.required\" class=\"text-warning\"\n                    >課程時間為必選欄位</span\n                  >\n                </template>\n              </div>\n            </div>\n\n            <!-- 滿班人數、可報名人數 -->\n            <div class=\"form__row\">\n              <div class=\"form__group\">\n                <label class=\"form__label\">滿班人數</label>\n                <input\n                  class=\"form__input\"\n                  placeholder=\"請填入人數\"\n                  type=\"number\"\n                  v-model.number=\"course.quantity\"\n                  :class=\"{ 'form__input--warning': $v.course.quantity.$error }\"\n                />\n                <template v-if=\"$v.course.quantity.$dirty\">\n                  <span v-if=\"!$v.course.quantity.required\" class=\"text-warning\"\n                    >滿班人數為必填欄位</span\n                  >\n                  <span v-if=\"!$v.course.quantity.minValue\" class=\"text-warning\"\n                    >人數至少0人</span\n                  >\n                </template>\n              </div>\n              <div class=\"form__group\">\n                <label class=\"form__label\">可報名人數</label>\n                <input\n                  class=\"form__input\"\n                  placeholder=\"請填入人數\"\n                  type=\"number\"\n                  v-model.number=\"course.remainQuantity\"\n                  :class=\"{\n                    'form__input--warning': $v.course.remainQuantity.$error,\n                  }\"\n                />\n                <template v-if=\"$v.course.remainQuantity.$dirty\">\n                  <span\n                    v-if=\"!$v.course.remainQuantity.required\"\n                    class=\"text-warning\"\n                    >可報名人數為必填欄位</span\n                  >\n                  <span\n                    v-if=\"!$v.course.remainQuantity.minValue\"\n                    class=\"text-warning\"\n                    >人數至少0人</span\n                  >\n                </template>\n              </div>\n            </div>\n\n            <!-- 課程原價、售價 -->\n            <div class=\"form__row\">\n              <div class=\"form__group\">\n                <label class=\"form__label\">原價</label>\n                <input\n                  class=\"form__input\"\n                  placeholder=\"請填入價格\"\n                  type=\"number\"\n                  v-model.number=\"course.originPrice\"\n                  :class=\"{\n                    'form__input--warning': $v.course.originPrice.$error,\n                  }\"\n                />\n                <template v-if=\"$v.course.originPrice.$dirty\">\n                  <span\n                    v-if=\"!$v.course.originPrice.required\"\n                    class=\"text-warning\"\n                    >原價為必填欄位</span\n                  >\n                  <span\n                    v-if=\"!$v.course.originPrice.minValue\"\n                    class=\"text-warning\"\n                    >價格必大於0</span\n                  >\n                </template>\n              </div>\n              <div class=\"form__group\">\n                <label class=\"form__label\">售價</label>\n                <input\n                  class=\"form__input\"\n                  placeholder=\"請填入價格\"\n                  type=\"number\"\n                  v-model.number=\"course.price\"\n                  :class=\"{ 'form__input--warning': $v.course.price.$error }\"\n                />\n                <template v-if=\"$v.course.price.$dirty\">\n                  <span v-if=\"!$v.course.price.required\" class=\"text-warning\"\n                    >售價為必填欄位</span\n                  >\n                  <span v-if=\"!$v.course.price.minValue\" class=\"text-warning\"\n                    >價格必大於0</span\n                  >\n                </template>\n              </div>\n            </div>\n\n            <!-- 精選課程 -->\n            <div class=\"form__row\">\n              <div class=\"form__group d-flex\" style=\"align-items:center\">\n                <input\n                  class=\"form__checkbox\"\n                  type=\"checkbox\"\n                  v-model=\"course.discount\"\n                />\n                <label class=\"form__label\">精選課程（優惠）</label>\n              </div>\n            </div>\n            <!-- 詳細課程內容 -->\n            <div class=\"form__row\">\n              <div class=\"form__group\">\n                <label class=\"form__label\">課程內容</label>\n                <VueEditor\n                  id=\"editor\"\n                  v-model=\"course.desc\"\n                  :placeholder=\"'請填入詳細課程內容'\"\n                ></VueEditor>\n              </div>\n            </div>\n          </div>\n        </div>\n      </form>\n\n      <!-- 送出按鈕 -->\n      <div class=\"form__row\">\n        <div class=\"form__group btn-footer\">\n          <button\n            style=\"width:100px\"\n            class=\"btn btn-primary\"\n            @click=\"addCourse\"\n            v-if=\"status === '新增課程'\"\n          >\n            新增\n          </button>\n          <button\n            style=\"width:100px\"\n            class=\"btn btn-primary\"\n            @click=\"updateCourse(course.id)\"\n            v-if=\"status === '編輯課程'\"\n          >\n            修改\n          </button>\n          <button\n            style=\"width:100px\"\n            class=\"btn btn-primary--cancel\"\n            @click=\"$router.go(-1)\"\n          >\n            取消\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { required, maxLength, minValue, url } from 'vuelidate/lib/validators';\nimport { VueEditor } from 'vue2-editor';\n\nexport default {\n  name: 'CourseNewEdit',\n  components: { VueEditor },\n  data() {\n    return {\n      prevRoute: false,\n      updateCover: false,\n      week: [\n        '星期一',\n        '星期二',\n        '星期三',\n        '星期四',\n        '星期五',\n        '星期六',\n        '星期日',\n      ],\n      category: ['有氧課程', '瑜珈課程', '游泳課程', '飛輪課程', '其他課程'],\n      coaches: [\n        'Amy珊珊',\n        'CICI',\n        'Danny',\n        'Papaya',\n        'Peco',\n        'Ryan',\n        '小惠',\n        '張三豐',\n        '強森',\n        '海德',\n        '阿Ni',\n        '阿壯',\n      ],\n      courseNew: {\n        title: '',\n        intro: '',\n        tags: [],\n        categorySelected: '',\n        coach: '',\n        week: '',\n        time: '',\n        quantity: null,\n        remainQuantity: null,\n        originPrice: null,\n        price: null,\n        discount: false,\n        imageUrl: '',\n        avgRating: 0,\n      },\n      course: null,\n      tag: null,\n      modal: null,\n      titleMax: 25,\n      introMax: 80,\n    };\n  },\n  validations: {\n    course: {\n      title: {\n        required,\n        maxLength: maxLength(24),\n      },\n      intro: {\n        required,\n        maxLength: maxLength(79),\n      },\n      categorySelected: {\n        required,\n      },\n      coach: {\n        required,\n      },\n      week: { required },\n      time: {\n        required,\n      },\n      originPrice: { required, minValue: minValue(0) },\n      price: { required, minValue: minValue(0) },\n      quantity: { required, minValue: minValue(0) },\n      remainQuantity: { required, minValue: minValue(0) },\n      imageUrl: { required, url },\n    },\n  },\n  computed: {\n    isLoading() {\n      return this.$store.state.isLoading;\n    },\n    status() {\n      return this.$store.state.courses.status;\n    },\n    getCourse() {\n      return this.$store.state.courses.course;\n    },\n    getDownloadURL() {\n      return this.$store.state.downloadURL;\n    },\n  },\n  watch: {\n    // 從編輯狀態切到新增狀態的話\n    status() {\n      if (this.status === '新增課程') {\n        this.course = { ...this.courseNew };\n      }\n    },\n    getDownloadURL() {\n      if (this.getDownloadURL) {\n        this.course.imageUrl = this.getDownloadURL;\n        this.updateCover = false;\n      }\n    },\n  },\n  methods: {\n    addCourse() {\n      this.$v.$touch();\n\n      if (this.$v.$invalid) {\n        this.$toasted.error('請正確填寫必要資訊', { duration: 3000 });\n      } else {\n        this.$store\n          .dispatch('courses/createCourse', { ...this.course })\n          .then(() => {\n            this.$toasted.success('成功新增課程', {\n              duration: 2000,\n            });\n            this.$router.push({ name: 'coursesAdmin' });\n          })\n          .catch((e) => console(e.message));\n      }\n    },\n    updateCourse(id) {\n      this.$v.$touch();\n      if (!this.updateCover) {\n        if (this.$v.$invalid) {\n          this.$toasted.error('請正確填寫必要資訊', { duration: 3000 });\n        } else {\n          this.$store\n            .dispatch('courses/updateCourse', { id, course: this.course })\n            .then(() => {\n              this.$toasted.success('更新成功!!', {\n                duration: 2000,\n              });\n              this.$router.push({ name: 'coursesAdmin' });\n            });\n        }\n      }\n    },\n    addTags() {\n      if (this.tag) {\n        this.course.tags.push(this.tag);\n      }\n      this.tag = '';\n    },\n    deleteTag(key) {\n      this.course.tags.splice(key, 1);\n    },\n    uploadImage(e) {\n      const file = e.target.files[0];\n      if (!file.type.includes('image')) {\n        this.$toasted.error('請上傳圖片檔案', { duration: 3000 });\n      } else {\n        this.updateCover = true;\n        this.$store.dispatch('updateFile', { file, place: 'courses/' });\n      }\n    },\n  },\n  created() {\n    this.$store.commit('setDownloadUrl', null);\n\n    if (this.status === '編輯課程') {\n      this.course = { ...this.getCourse };\n    } else {\n      this.course = { ...this.courseNew };\n    }\n  },\n};\n</script>\n\n<style>\n#editor {\n  height: 250px;\n}\n</style>\n"],"sourceRoot":"src/views/backend"}]}