{"remainingRequest":"/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangpei-yu/Front-Gym/src/views/frontend/Courses.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangpei-yu/Front-Gym/src/views/frontend/Courses.vue","mtime":1584870829872},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport $ from \"jquery\";\nimport CourseCard from \"@/components/CourseCard\";\nimport CourseList from \"@/components/CourseList\";\n\nexport default {\n  name: \"Courses\",\n  props: [\"navbar\"],\n  components: {\n    CourseCard,\n    CourseList\n  },\n  data() {\n    return {\n      property: \"ratingOrder\",\n      order: false,\n      priceOrder: true,\n      ratingOrder: true,\n      searchShow: false,\n      searchWord: null,\n      keyWord: null,\n      showNavbar: true,\n      lastScrollPosition: 0,\n      count: 0,\n      infiniteData: [],\n      busy: false,\n      cates: []\n    };\n  },\n  computed: {\n    isLoading() {\n      return this.$store.state.isLoading;\n    },\n    //全部課程\n    courses() {\n      return this.$store.state.courses.courses.filter(\n        course => course.remainQuantity > 0 && course.discount\n      );\n    },\n    //排序課程\n    coursesOrdered() {\n      const course = [...this.$store.state.courses.courses].sort(\n        (a, b) => b[this.property] - a[this.property]\n      );\n      return this.order ? course : course.reverse();\n    },\n    //選取分類\n    cat() {\n      return this.$store.state.courses.cat;\n    }\n  },\n\n  methods: {\n    reset() {\n      this.searchShow = false;\n      this.searchWord = null;\n      this.count = 0;\n      this.infiniteData = [];\n    },\n\n    //選擇分類\n    selectCat(cat) {\n      //避免double click\n      if (this.cat !== cat) {\n        this.reset();\n        this.$store.dispatch(\"courses/getCourses\", cat);\n      }\n    },\n\n    //sub-nav滾動\n    scrollSubNav() {\n      const currentScrollPosition =\n        window.pageYOffset || document.documentElement.scrollTop;\n      if (currentScrollPosition < 0) {\n        return;\n      }\n      if (Math.abs(currentScrollPosition - this.lastScrollPosition) < 60) {\n        return;\n      }\n      this.showNavbar = currentScrollPosition < this.lastScrollPosition;\n      this.lastScrollPosition = currentScrollPosition;\n    },\n\n    //往下滾動出現課程\n    loadMore() {\n      let arrayShow = [...this.coursesOrdered];\n      if (this.infiniteData.length <= arrayShow.length) {\n        this.busy = true;\n        setTimeout(() => {\n          for (var i = 0, j = 5; i < j; i++) {\n            if (this.count === arrayShow.length) {\n              break;\n            }\n            this.infiniteData.push(arrayShow[this.count++]);\n          }\n          this.busy = false;\n        }, 500);\n      }\n    },\n\n    //搜尋課程\n    searchCourse() {\n      //如果輸入框中有字\n      if (this.searchWord) {\n        this.keyWord = this.searchWord;\n        this.reset();\n        this.searchShow = true;\n        //符合課程\n        this.$store.dispatch(\"courses/getCourses\", \"所有課程\").then(courses => {\n          const filteredCourses =\n            courses.filter(course => course.title.match(this.keyWord)) || [];\n          this.$store.commit(\"courses/setCourses\", filteredCourses);\n          this.loadMore();\n        });\n      } else {\n        this.$toasted.error(\"請輸入搜尋字詞\", { duration: 3000 });\n      }\n    },\n\n    //排序課程\n    orderCourse(property, order) {\n      this.property = property;\n      this.order = order;\n      this.count = 0;\n      this.infiniteData = [];\n      this.loadMore();\n    }\n  },\n  //scroll特效\n  mounted() {\n    $(window).scroll(this.scrollSubNav);\n  },\n\n  created() {\n    this.reset();\n    if (this.$store.state.courses.courses.length === 0) {\n      this.$store.dispatch(\"courses/getCourses\", \"所有課程\");\n    }\n  }\n};\n",{"version":3,"sources":["Courses.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Courses.vue","sourceRoot":"src/views/frontend","sourcesContent":["<template>\n  <div>\n    <loading :active.sync=\"isLoading\" :opacity=\".8\" :background-color=\"'#000'\" :color=\"'#ff5722'\"></loading>\n\n    <!-- sub-nav -->\n    <nav class=\"sub-nav\" :class=\"{'sub-nav--hidden': !showNavbar}\">\n      <ul class=\"sub-nav__list\">\n        <li\n          v-for=\"cat in navbar\"\n          :key=\"cat.cat\"\n          class=\"sub-nav__item\"\n          @click.prevent=\"selectCat(cat.cat)\"\n        >\n          <a class=\"sub-nav__link\">\n            <i :class=\"`${cat.icon}`\"></i>\n            <p>{{cat.cat}}</p>\n          </a>\n        </li>\n      </ul>\n    </nav>\n    <main class=\"courses-main\" id=\"courseMain\">\n      <header class=\"courses-header\" v-if=\"!searchShow\">\n        <div class=\"container\">\n          <h2 class=\"courses-header__title\">{{cat}}</h2>\n          <p class=\"courses-header__text\">{{navbar.filter(intro=>intro.cat===cat)[0].des}}</p>\n        </div>\n      </header>\n      <div class=\"container\">\n        <!-- 精選課程區 -->\n        <section v-if=\"!searchShow\">\n          <div class=\"section-title\">\n            <h2 class=\"section-title__name\">精選{{cat}}</h2>\n          </div>\n          <transition name=\"slide-fade\">\n            <course-card v-if=\"courses.length>0\" :selectedCat=\"cat\" :course-card=\"courses\"></course-card>\n          </transition>\n        </section>\n\n        <!-- 全部課程區 -->\n        <section>\n          <div class=\"section-title\" v-if=\"!searchShow\">\n            <h2 class=\"section-title__name\">全部{{cat}}</h2>\n          </div>\n          <!-- 沒有課程結果 -->\n          <div class=\"search-result\" v-if=\"searchShow&&!isLoading\">\n            <div v-if=\"coursesOrdered.length===0\">\n              <p>\n                抱歉，我們找不到有關「{{keyWord}}」的任何結果\n                <br>請嘗試調整您的搜索。以下是幾點建議：\n              </p>\n              <ul>\n                <li>確保所有字詞拼寫正確。</li>\n                <li>嘗試不同的搜索詞。</li>\n                <li>嘗試更常見的搜索字詞。</li>\n              </ul>\n            </div>\n            <div v-else>關於「{{keyWord}}」的 {{coursesOrdered.length}} 筆结果：</div>\n          </div>\n          <!-- filter&search tool bar-->\n          <div class=\"courses-filter\">\n            <div class=\"courses-filter__list\">\n              <!-- 課程搜尋 -->\n              <div class=\"search\">\n                <input\n                  type=\"text\"\n                  class=\"search__input\"\n                  v-model.trim=\"searchWord\"\n                  placeholder=\"搜尋課程\"\n                  @keyup.enter=\"searchCourse()\"\n                >\n                <button class=\"search__btn btn\" @click=\"searchCourse()\">\n                  <div class=\"search__icon\">\n                    <i class=\"fas fa-search\"></i>\n                  </div>\n                </button>\n              </div>\n              <!-- 課程排序 -->\n              <div class=\"courses-filter__btn-group d-flex\">\n                <div class=\"courses-filter__item\">\n                  <button\n                    @click=\"priceOrder=!priceOrder;orderCourse('price',priceOrder)\"\n                    class=\"courses-filter__btn btn\"\n                  >\n                    <i v-if=\"priceOrder\" class=\"fas fa-chevron-down\"></i>\n                    <i v-else class=\"fas fa-chevron-up\"></i>\n                    價格\n                  </button>\n                </div>\n                <div class=\"courses-filter__item\">\n                  <button\n                    @click=\"ratingOrder=!ratingOrder;orderCourse('avgRating',ratingOrder)\"\n                    class=\"courses-filter__btn btn\"\n                  >\n                    <i v-if=\"ratingOrder\" class=\"fas fa-chevron-down\"></i>\n                    <i v-else class=\"fas fa-chevron-up\"></i>\n                    評等\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n\n        <!-- 全部課程List -->\n        <section>\n          <course-list :courses-list=\"infiniteData\" v-if=\"infiniteData.length>0\"></course-list>\n          <div\n            class=\"ifinite-scroll\"\n            v-infinite-scroll=\"loadMore\"\n            infinite-scroll-disabled=\"busy\"\n            infinite-scroll-distance=\"15\"\n            infinite-scroll-immediate-check=\"false\"\n          >\n            <div v-if=\"busy&&infiniteData.length!==coursesOrdered.length\">\n              <i class=\"fas fa-spinner fa-spin\"></i>\n            </div>\n\n            <a class=\"gotop\" href=\"#courseMain\" v-if=\"infiniteData.length==coursesOrdered.length\">\n              <i class=\"fas fa-chevron-up\"></i> 返回頂部\n            </a>\n          </div>\n        </section>\n      </div>\n    </main>\n    <add-to-cart-modal></add-to-cart-modal>\n  </div>\n</template>\n\n<script>\nimport $ from \"jquery\";\nimport CourseCard from \"@/components/CourseCard\";\nimport CourseList from \"@/components/CourseList\";\n\nexport default {\n  name: \"Courses\",\n  props: [\"navbar\"],\n  components: {\n    CourseCard,\n    CourseList\n  },\n  data() {\n    return {\n      property: \"ratingOrder\",\n      order: false,\n      priceOrder: true,\n      ratingOrder: true,\n      searchShow: false,\n      searchWord: null,\n      keyWord: null,\n      showNavbar: true,\n      lastScrollPosition: 0,\n      count: 0,\n      infiniteData: [],\n      busy: false,\n      cates: []\n    };\n  },\n  computed: {\n    isLoading() {\n      return this.$store.state.isLoading;\n    },\n    //全部課程\n    courses() {\n      return this.$store.state.courses.courses.filter(\n        course => course.remainQuantity > 0 && course.discount\n      );\n    },\n    //排序課程\n    coursesOrdered() {\n      const course = [...this.$store.state.courses.courses].sort(\n        (a, b) => b[this.property] - a[this.property]\n      );\n      return this.order ? course : course.reverse();\n    },\n    //選取分類\n    cat() {\n      return this.$store.state.courses.cat;\n    }\n  },\n\n  methods: {\n    reset() {\n      this.searchShow = false;\n      this.searchWord = null;\n      this.count = 0;\n      this.infiniteData = [];\n    },\n\n    //選擇分類\n    selectCat(cat) {\n      //避免double click\n      if (this.cat !== cat) {\n        this.reset();\n        this.$store.dispatch(\"courses/getCourses\", cat);\n      }\n    },\n\n    //sub-nav滾動\n    scrollSubNav() {\n      const currentScrollPosition =\n        window.pageYOffset || document.documentElement.scrollTop;\n      if (currentScrollPosition < 0) {\n        return;\n      }\n      if (Math.abs(currentScrollPosition - this.lastScrollPosition) < 60) {\n        return;\n      }\n      this.showNavbar = currentScrollPosition < this.lastScrollPosition;\n      this.lastScrollPosition = currentScrollPosition;\n    },\n\n    //往下滾動出現課程\n    loadMore() {\n      let arrayShow = [...this.coursesOrdered];\n      if (this.infiniteData.length <= arrayShow.length) {\n        this.busy = true;\n        setTimeout(() => {\n          for (var i = 0, j = 5; i < j; i++) {\n            if (this.count === arrayShow.length) {\n              break;\n            }\n            this.infiniteData.push(arrayShow[this.count++]);\n          }\n          this.busy = false;\n        }, 500);\n      }\n    },\n\n    //搜尋課程\n    searchCourse() {\n      //如果輸入框中有字\n      if (this.searchWord) {\n        this.keyWord = this.searchWord;\n        this.reset();\n        this.searchShow = true;\n        //符合課程\n        this.$store.dispatch(\"courses/getCourses\", \"所有課程\").then(courses => {\n          const filteredCourses =\n            courses.filter(course => course.title.match(this.keyWord)) || [];\n          this.$store.commit(\"courses/setCourses\", filteredCourses);\n          this.loadMore();\n        });\n      } else {\n        this.$toasted.error(\"請輸入搜尋字詞\", { duration: 3000 });\n      }\n    },\n\n    //排序課程\n    orderCourse(property, order) {\n      this.property = property;\n      this.order = order;\n      this.count = 0;\n      this.infiniteData = [];\n      this.loadMore();\n    }\n  },\n  //scroll特效\n  mounted() {\n    $(window).scroll(this.scrollSubNav);\n  },\n\n  created() {\n    this.reset();\n    if (this.$store.state.courses.courses.length === 0) {\n      this.$store.dispatch(\"courses/getCourses\", \"所有課程\");\n    }\n  }\n};\n</script>\n"]}]}