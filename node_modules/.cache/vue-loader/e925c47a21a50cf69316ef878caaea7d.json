{"remainingRequest":"/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangpei-yu/Front-Gym/src/views/frontend/CheckoutInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangpei-yu/Front-Gym/src/views/frontend/CheckoutInfo.vue","mtime":1584962984650},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport StepBar from '@/components/StepBar';\nimport moment from 'moment';\n\nexport default {\n  name: 'CheckoutInfo',\n  components: {\n    StepBar,\n  },\n  data() {\n    return {\n      paymentId: null,\n    };\n  },\n  computed: {\n    time() {\n      return moment(this.payment.finishedAt).format('YYYY/MM/DD HH:mm');\n    },\n    isLoading() {\n      return this.$store.state.isLoading;\n    },\n    payment() {\n      return this.$store.state.checkout.payment;\n    },\n    // user\n    user() {\n      return this.$store.state.checkout.payment.user;\n    },\n    // 價格相關\n    total() {\n      return this.$store.state.checkout.payment.total;\n    },\n    // 課程相關\n    courses() {\n      return this.$store.state.checkout.payment.courses;\n    },\n    // 進度狀態顯示\n    status() {\n      return this.payment.status === '付款完成' ? 'success' : 'checkout';\n    },\n  },\n\n  methods: {\n    checkOut(id) {\n      // 更改訂單付款狀態\n      this.$store.dispatch('checkout/finishPayment', id).then(() => {\n        // 結帳成功提示\n        this.$toasted.success('付款成功，感謝購買！', {\n          duration: 2000,\n        });\n      });\n    },\n  },\n  created() {\n    this.paymentId = this.$route.params.paymentId;\n\n    this.$store.dispatch('checkout/getPaymentById', this.paymentId);\n  },\n};\n",{"version":3,"sources":["CheckoutInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoIA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"CheckoutInfo.vue","sourceRoot":"src/views/frontend","sourcesContent":["<template>\n  <div>\n    <loading\n      :active.sync=\"isLoading\"\n      :opacity=\"0.8\"\n      :background-color=\"'#000'\"\n      :color=\"'#ff5722'\"\n    ></loading>\n\n    <main class=\"courses-main\">\n      <div class=\"container\">\n        <step-bar :status=\"status\"></step-bar>\n\n        <div class=\"checkout\">\n          <div class=\"checkout__info mb-sm\">\n            <!-- 購買課程 -->\n            <div class=\"checkout-form checkout-payment__courses mb-sm\">\n              <div class=\"heading-tertiary--dark mb-sm\">\n                <i class=\"fas fa-money-check fa-lg\"></i> 結帳金額\n              </div>\n              <table class=\"checkout-table\">\n                <thead>\n                  <tr>\n                    <th>課程名稱</th>\n                    <th class=\"d-none-phone\">購買方案</th>\n                    <th class=\"d-none-phone\">原價</th>\n                    <th>售價</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr v-for=\"course in payment.courses\" :key=\"course.title\">\n                    <td>{{ course.title }}</td>\n                    <td class=\"d-none-phone\">\n                      <template v-if=\"course.discount\">精選優惠</template>\n                      <template v-else>課程售價</template>\n                    </td>\n                    <td class=\"d-none-phone\" style=\"text-align:right\">\n                      {{ course.price | currency }}\n                    </td>\n\n                    <td style=\"text-align:right\">\n                      {{ course.sellingPrice | currency }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n              <div class=\"checkout-payment__total\">\n                實付金額\n                <b class=\"ml-sm\">{{ total.totalPrice | currency }}</b>\n              </div>\n            </div>\n            <!-- 付款資訊 -->\n            <div class=\"checkout-form checkout-payment__user\">\n              <div class=\"heading-tertiary--dark mb-sm\">\n                <i class=\"far fa-address-card fa-lg\"></i> 付款資訊\n              </div>\n              <div class=\"checkout-payment__invoice\">\n                <div>\n                  <b>付款方式</b>\n                  <p>{{ user.payWay }}</p>\n                </div>\n                <div>\n                  <b>發票資訊</b>\n                  <p>聯絡人：{{ user.name }}</p>\n                  <p>聯絡電子信箱：{{ user.email }}</p>\n                  <p>聯絡電話：{{ user.phone }}</p>\n                </div>\n              </div>\n            </div>\n          </div>\n          <!-- 付款狀態 -->\n          <div class=\"checkout__summary\" v-if=\"payment.status === '尚未付款'\">\n            <div class=\"checkout__summary-title heading-tertiary--dark\">\n              訂單明細\n            </div>\n\n            <div class=\"checkout__summary-price\">\n              <div>原價</div>\n              <div>{{ total.totalOrigin | currency }}</div>\n            </div>\n            <div class=\"checkout__summary-price\" v-if=\"total.totalDiscount > 0\">\n              <div>優惠券折扣</div>\n              <div>-{{ total.totalDiscount | currency }}</div>\n            </div>\n            <div class=\"checkout__summary-total\">\n              <div>總計</div>\n              <h3>{{ total.totalPrice | currency }}</h3>\n            </div>\n            <button\n              class=\"btn btn-primary\"\n              style=\"display: inline-block; background-color: rgb(255, 87, 33); border-left-color: rgb(255, 87, 33); border-right-color: rgb(255, 87, 33);\"\n              @click.prevent=\"checkOut(payment.id)\"\n            >\n              確認付款\n            </button>\n          </div>\n\n          <!-- 付款成功 -->\n          <div\n            class=\"checkout__summary checkout__summary--success mb-sm\"\n            v-if=\"payment.status === '付款完成'\"\n          >\n            <div class=\"mb-sm heading-tertiary--dark\">付款成功 感謝購買</div>\n\n            <img\n              class=\"mb-sm mt-sm\"\n              width=\"100px\"\n              src=\"@/assets/img/checked.svg\"\n            />\n            <ul class=\"checkout__summary-list\">\n              <li class=\"checkout__summary-item\">\n                訂單編號：\n                <br />\n                {{ payment.id }}\n              </li>\n              <li class=\"checkout__summary-item\">\n                購買時間：\n                <br />\n                {{ time }}\n              </li>\n              <li class=\"checkout__summary-item\">\n                付款金額：{{ total.totalPrice | currency }}\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </main>\n  </div>\n</template>\n\n<script>\nimport StepBar from '@/components/StepBar';\nimport moment from 'moment';\n\nexport default {\n  name: 'CheckoutInfo',\n  components: {\n    StepBar,\n  },\n  data() {\n    return {\n      paymentId: null,\n    };\n  },\n  computed: {\n    time() {\n      return moment(this.payment.finishedAt).format('YYYY/MM/DD HH:mm');\n    },\n    isLoading() {\n      return this.$store.state.isLoading;\n    },\n    payment() {\n      return this.$store.state.checkout.payment;\n    },\n    // user\n    user() {\n      return this.$store.state.checkout.payment.user;\n    },\n    // 價格相關\n    total() {\n      return this.$store.state.checkout.payment.total;\n    },\n    // 課程相關\n    courses() {\n      return this.$store.state.checkout.payment.courses;\n    },\n    // 進度狀態顯示\n    status() {\n      return this.payment.status === '付款完成' ? 'success' : 'checkout';\n    },\n  },\n\n  methods: {\n    checkOut(id) {\n      // 更改訂單付款狀態\n      this.$store.dispatch('checkout/finishPayment', id).then(() => {\n        // 結帳成功提示\n        this.$toasted.success('付款成功，感謝購買！', {\n          duration: 2000,\n        });\n      });\n    },\n  },\n  created() {\n    this.paymentId = this.$route.params.paymentId;\n\n    this.$store.dispatch('checkout/getPaymentById', this.paymentId);\n  },\n};\n</script>\n"]}]}