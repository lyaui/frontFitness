{"remainingRequest":"/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangpei-yu/Front-Gym/src/views/coursesAdmin.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangpei-yu/Front-Gym/src/views/coursesAdmin.vue","mtime":1582449194684},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/Front-Gym/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { fb, db } from \"@/firebase/init\";\nimport { VueEditor } from \"vue2-editor\";\nimport Pagination from \"@/components/Pagination\";\nimport Swal from \"sweetalert2\";\n// import { getHeapSnapshot } from \"v8\";\n\nexport default {\n  components: { Pagination, VueEditor },\n  data() {\n    return {\n      courses: [],\n      week: [\n        \"星期一\",\n        \"星期二\",\n        \"星期三\",\n        \"星期四\",\n        \"星期五\",\n        \"星期六\",\n        \"星期日\"\n      ],\n      category: [\"有氧課程\", \"瑜珈課程\", \"游泳課程\", \"飛輪課程\", \"其他課程\"],\n      course: {\n        categorySelected: null,\n        coach: null,\n        details: null,\n        imageUrl: null,\n        intro: \"\",\n        time: null,\n        week: null,\n        originPrice: null,\n        price: null,\n        quantity: null,\n        remainQuantity: null,\n        title: \"\",\n        tags: [],\n        discount: false,\n        avgRating: 0\n      },\n      tag: null,\n      modal: null,\n      titleMax: 25,\n      introMax: 80,\n      modalPage: 1,\n      isLoading: false\n    };\n  },\n  firestore() {\n    const vm = this;\n    vm.isLoading = true;\n\n    return {\n      courses: {\n        ref: db\n          .collection(\"courses\")\n          .orderBy(\"categorySelected\", \"desc\")\n          .limit(10),\n        resolve: data => {\n          vm.isLoading = false;\n        }\n      }\n    };\n  },\n  computed: {\n    textCounter() {\n      return this.course.title;\n    }\n  },\n  methods: {\n    deleteCourse(course) {\n      Swal.fire({\n        title: `確定刪除 ${course.title} 嗎？`,\n        text: `課程一經刪除將無法復原！`,\n        type: \"warning\",\n        showCancelButton: true,\n        confirmButtonText: \"確定\",\n        cancelButtonText: \"取消\",\n        confirmButtonColor: \"#ff5721\",\n        cancelButtonColor: \"#cecece\"\n      }).then(result => {\n        if (result.value) {\n          this.$firestore.courses.doc(course.id).delete();\n          Swal.fire({\n            type: \"success\",\n            title: `${course.title} 已成功刪除！`,\n            showConfirmButton: false,\n            timer: 1000\n          });\n        } else if (result.dismiss === Swal.DismissReason.cancel) {\n          return;\n        }\n      });\n    },\n    addCourse() {\n      this.$firestore.courses.add(this.course);\n\n      Swal.fire({\n        type: \"success\",\n        title: `${this.course.title} 新增成功！`,\n        showConfirmButton: false,\n        timer: 1000\n      });\n      this.hideModal();\n    },\n    updateCourse(course) {\n      this.$firestore.courses.doc(course.id).update(this.course);\n      Swal.fire({\n        type: \"success\",\n        title: `${this.course.title} 編輯成功！`,\n        showConfirmButton: false,\n        timer: 1000\n      });\n      this.hideModal();\n    },\n    addTags() {\n      if (this.tag) {\n        this.course.tags.push(this.tag);\n      }\n      this.tag = \"\";\n    },\n    deleteTag(key) {\n      this.course.tags.splice(key, 1);\n    },\n\n    uploadImage(e) {\n      let file = e.target.files[0];\n      var storageRef = firebase.storage().ref(\"courses\" + file.name);\n      storageRef.put(file);\n      console.log(e.target.files[0]);\n    },\n    reset() {\n      // Object.assign(this.$data.course, initialState());\n      this.course = {\n        categorySelected: null,\n        coach: null,\n        details: null,\n        imageUrl: null,\n        intro: \"\",\n        time: null,\n        week: null,\n        originPrice: null,\n        price: null,\n        quantity: null,\n        remainQuantity: null,\n        title: \"\",\n        tags: [],\n        discount: false,\n        avgRating: 0\n      };\n\n      this.modalPage = 1;\n    },\n\n    showModal(isNew, course) {\n      this.$modal.show(\"productModal\", {});\n      if (isNew) {\n        this.modal = \"新增課程\";\n        this.reset();\n      } else {\n        this.modal = \"編輯課程\";\n        this.course = course;\n      }\n    },\n    hideModal() {\n      this.$modal.hide(\"productModal\");\n      this.reset();\n    }\n  }\n};\n",{"version":3,"sources":["coursesAdmin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8RA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"coursesAdmin.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <loading :active.sync=\"isLoading\" :color=\"'#ff5722'\"></loading>\n    <h2 class=\"heading-secondary\">課程列表</h2>\n    <button class=\"btn products-admin-btn\" @click=\"showModal(true)\">\n      <i class=\"fas fa-plus-square\"></i> 新增課程\n    </button>\n\n    <table class=\"admin-table\">\n      <thead>\n        <tr>\n          <th class=\"d-none-phone\">圖示</th>\n          <th>類別</th>\n          <th>課程名稱</th>\n          <th>精選</th>\n          <th>剩餘數量</th>\n          <th>原價</th>\n          <th>售價</th>\n          <th class=\"d-none-phone\">編輯</th>\n        </tr>\n      </thead>\n\n      <tbody>\n        <tr v-for=\"(course,index) in courses\" :class=\"{'lighten-row':index%2==1}\" :key=\"course.id\">\n          <td class=\"d-none-phone\">\n            <img class=\"course-admin__img\" :src=\"course.imageUrl\" :alt=\"course.title\">\n          </td>\n          <td>{{course.categorySelected}}</td>\n          <td>\n            <router-link\n              :to=\"{name:'CourseDetails',params:{course_name:course.title}}\"\n            >{{course.title}}</router-link>\n          </td>\n\n          <td>\n            <div v-if=\"course.discount\">&#10004</div>\n            <div v-else>-</div>\n          </td>\n\n          <td\n            :class=\"{'text-highlight':course.remainQuantity===0}\"\n          >{{course.remainQuantity}}/{{course.quantity}}</td>\n          <td>{{course.originPrice|currency}}</td>\n          <td>{{course.price|currency}}</td>\n          <td class=\"d-none-phone\">\n            <button class=\"btn products-admin-btn\" @click=\"showModal(false,course)\">\n              <i class=\"fas fa-edit\"></i>\n            </button>\n            <button class=\"btn products-admin-btn\" @click=\"deleteCourse(course)\">\n              <i class=\"fas fa-trash-alt\"></i>\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <!-- <Pagination></Pagination> -->\n    <div>\n      <ul class=\"pagination\">\n        <li class=\"page-item\">\n          <a href class=\"page-link\">\n            <i class=\"fas fa-angle-double-left\">上一頁</i>\n          </a>\n        </li>\n\n        <li class=\"page-item\">\n          <a href class=\"page-link\">\n            <i class=\"fas fa-angle-double-right\">下一頁</i>\n          </a>\n        </li>\n      </ul>\n    </div>\n\n    <!-- modal -->\n    <modal\n      name=\"productModal\"\n      :resizable=\"true\"\n      :adaptive=\"true\"\n      :clickToClose=\"false\"\n      :maxWidth=\"700\"\n      :minHeight=\"600\"\n    >\n      <div class=\"add-course\">\n        <div class=\"modal-title\">{{modal}}</div>\n\n        <form class=\"add-course__form\" v-if=\"modalPage===1\">\n          <div class=\"form__row\">\n            <div class=\"form__group\">\n              <label class=\"form__label\">課程名稱</label>\n              <div class=\"d-flex\">\n                <input\n                  class=\"form__input\"\n                  placeholder=\"請填入課程名稱\"\n                  type=\"text\"\n                  v-model=\"course.title\"\n                  :maxlength=\"titleMax\"\n                >\n                <div class=\"form__counter\">\n                  <span>{{titleMax-course.title.length}}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"form__row\">\n            <div class=\"form__group\">\n              <label class=\"form__label\">課程簡介</label>\n              <div class=\"d-flex\">\n                <input\n                  class=\"form__input\"\n                  placeholder=\"請填入課程簡介\"\n                  type=\"textarea\"\n                  v-model=\"course.intro\"\n                  style=\"padding-right:40px\"\n                  :maxlength=\"introMax\"\n                >\n                <div class=\"form__counter\">\n                  <span>{{introMax-course.intro.length}}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"form__group\" style=\"margin-right:0px\">\n            <div class=\"form__tag-case\">\n              <label class=\"form__label\">標籤</label>\n\n              <div class=\"form__tag\" v-for=\"(tag,key) in course.tags\" :key=\"key\">\n                {{tag}}\n                <i class=\"fas fa-times-circle\" @click=\"deleteTag(key)\"></i>\n              </div>\n            </div>\n            <input\n              class=\"form__input\"\n              type=\"text\"\n              @keyup.enter=\"addTags()\"\n              v-model=\"tag\"\n              placeholder=\"請填入標籤並以enter隔開\"\n            >\n          </div>\n          <div class>\n            <div class=\"form__row\">\n              <div class=\"form__group\">\n                <label class=\"form__label\">課程內容</label>\n                <VueEditor id=\"editor\" v-model=\"course.desc\" :placeholder=\"'請填入詳細課程內容'\"></VueEditor>\n              </div>\n            </div>\n          </div>\n        </form>\n        <form class=\"add-course__form\" v-if=\"modalPage===2\">\n          <div class=\"form__row\">\n            <div class=\"form__group\">\n              <label class=\"form__label\">課程類別</label>\n              <select class=\"form__input\" v-model=\"course.categorySelected\">\n                <option :value=\"null\" disabled>請選擇課程類別</option>\n                <option :value=\"item\" v-for=\"(item,key) in category\" :key=\"key\">{{item}}</option>\n              </select>\n            </div>\n            <div class=\"form__group\">\n              <label class=\"form__label\">課程教練</label>\n              <input class=\"form__input\" placeholder=\"請填入教練\" type=\"text\" v-model=\"course.coach\">\n            </div>\n          </div>\n\n          <div class=\"form__row\">\n            <div class=\"form__group\">\n              <label class=\"form__label\">上課星期</label>\n              <select class=\"form__input\" v-model=\"course.week\">\n                <option value disabled selected>請選擇星期</option>\n                <option v-for=\"day in week\" :key=\"day\">{{day}}</option>\n              </select>\n            </div>\n            <div class=\"form__group\">\n              <label class=\"form__label\">上課時間</label>\n              <select class=\"form__input\" v-model=\"course.time\">\n                <optgroup label=\"上午\">\n                  <option value=\"上午09:00~10:00\" default selected>09:00~10:00</option>\n                  <option value=\"上午10:00~11:00\">10:00~11:00</option>\n                  <option value=\"上午11:00~12:00\">11:00~12:00</option>\n                </optgroup>\n                <optgroup label=\"中午\">\n                  <option value=\"中午14:00~15:00\">14:00~15:00</option>\n                  <option value=\"中午15:00~16:00\">15:00~16:00</option>\n                  <option value=\"中午16:00~17:00\">16:00~17:00</option>\n                </optgroup>\n                <optgroup label=\"晚上\">\n                  <option value=\"晚上18:00~19:00\">18:00~19:00</option>\n                  <option value=\"晚上19:00~20:00\">19:00~20:00</option>\n                  <option value=\"晚上20:00~21:00\">20:00~21:00</option>\n                </optgroup>\n              </select>\n            </div>\n          </div>\n          <div class=\"form__row\">\n            <div class=\"form__group\">\n              <label class=\"form__label\">滿班人數</label>\n              <input\n                class=\"form__input\"\n                placeholder=\"請填入人數\"\n                type=\"number\"\n                v-model.number=\"course.quantity\"\n              >\n            </div>\n            <div class=\"form__group\">\n              <label class=\"form__label\">可報名人數</label>\n              <input\n                class=\"form__input\"\n                placeholder=\"請填入人數\"\n                type=\"number\"\n                v-model.number=\"course.remainQuantity\"\n              >\n            </div>\n          </div>\n          <div class=\"form__row\">\n            <div class=\"form__group\">\n              <label class=\"form__label\">原價</label>\n              <input\n                class=\"form__input\"\n                placeholder=\"請填入價格\"\n                type=\"number\"\n                v-model.number=\"course.originPrice\"\n              >\n            </div>\n            <div class=\"form__group\">\n              <label class=\"form__label\">售價</label>\n              <input\n                class=\"form__input\"\n                placeholder=\"請填入價格\"\n                type=\"number\"\n                v-model.number=\"course.price\"\n              >\n            </div>\n          </div>\n\n          <div class=\"form__row\">\n            <div class=\"form__group d-flex\">\n              <input class=\"form__checkbox\" type=\"checkbox\" v-model=\"course.discount\">\n              <label class=\"form__label\">精選課程（優惠）</label>\n            </div>\n          </div>\n          <div class=\"form__row\">\n            <img\n              class=\"form__img\"\n              src=\"https://fakeimg.pl/250x150/?retina=1&text=請上傳圖片&font=noto\"\n              alt\n            >\n\n            <div>\n              <div class=\"form__group\">\n                <label class=\"form__label\">輸入圖片網址</label>\n                <input class=\"form__input\" type=\"text\" v-model=\"course.imageUrl\">\n              </div>\n              <div class=\"form__group\">\n                <label class=\"form__label\">或 選擇圖片檔案</label>\n                <input class=\"form__input\" type=\"file\">\n              </div>\n            </div>\n          </div>\n        </form>\n\n        <div class=\"modal-buttons\">\n          <button class=\"swal2-cancel swal2-styled\" @click=\"hideModal\">取消</button>\n          <div class>\n            <button\n              class=\"swal2-confirm swal2-styled\"\n              style=\"display: inline-block; background-color: rgb(255, 87, 33); border-left-color: rgb(255, 87, 33); border-right-color: rgb(255, 87, 33);\"\n              @click=\"modalPage=2\"\n              v-if=\"modalPage===1\"\n            >繼續</button>\n            <button\n              class=\"swal2-confirm swal2-styled\"\n              style=\"display: inline-block; background-color: rgb(255, 87, 33); border-left-color: rgb(255, 87, 33); border-right-color: rgb(255, 87, 33);\"\n              @click=\"addCourse()\"\n              v-if=\"modal=='新增課程'\"\n            >新增</button>\n            <button\n              class=\"swal2-confirm swal2-styled\"\n              style=\"display: inline-block; background-color: rgb(255, 87, 33); border-left-color: rgb(255, 87, 33); border-right-color: rgb(255, 87, 33);\"\n              @click=\"updateCourse(course)\"\n              v-if=\"modal=='編輯課程'\"\n            >修改</button>\n          </div>\n        </div>\n      </div>\n    </modal>\n  </div>\n</template>\n\n<script>\nimport { fb, db } from \"@/firebase/init\";\nimport { VueEditor } from \"vue2-editor\";\nimport Pagination from \"@/components/Pagination\";\nimport Swal from \"sweetalert2\";\n// import { getHeapSnapshot } from \"v8\";\n\nexport default {\n  components: { Pagination, VueEditor },\n  data() {\n    return {\n      courses: [],\n      week: [\n        \"星期一\",\n        \"星期二\",\n        \"星期三\",\n        \"星期四\",\n        \"星期五\",\n        \"星期六\",\n        \"星期日\"\n      ],\n      category: [\"有氧課程\", \"瑜珈課程\", \"游泳課程\", \"飛輪課程\", \"其他課程\"],\n      course: {\n        categorySelected: null,\n        coach: null,\n        details: null,\n        imageUrl: null,\n        intro: \"\",\n        time: null,\n        week: null,\n        originPrice: null,\n        price: null,\n        quantity: null,\n        remainQuantity: null,\n        title: \"\",\n        tags: [],\n        discount: false,\n        avgRating: 0\n      },\n      tag: null,\n      modal: null,\n      titleMax: 25,\n      introMax: 80,\n      modalPage: 1,\n      isLoading: false\n    };\n  },\n  firestore() {\n    const vm = this;\n    vm.isLoading = true;\n\n    return {\n      courses: {\n        ref: db\n          .collection(\"courses\")\n          .orderBy(\"categorySelected\", \"desc\")\n          .limit(10),\n        resolve: data => {\n          vm.isLoading = false;\n        }\n      }\n    };\n  },\n  computed: {\n    textCounter() {\n      return this.course.title;\n    }\n  },\n  methods: {\n    deleteCourse(course) {\n      Swal.fire({\n        title: `確定刪除 ${course.title} 嗎？`,\n        text: `課程一經刪除將無法復原！`,\n        type: \"warning\",\n        showCancelButton: true,\n        confirmButtonText: \"確定\",\n        cancelButtonText: \"取消\",\n        confirmButtonColor: \"#ff5721\",\n        cancelButtonColor: \"#cecece\"\n      }).then(result => {\n        if (result.value) {\n          this.$firestore.courses.doc(course.id).delete();\n          Swal.fire({\n            type: \"success\",\n            title: `${course.title} 已成功刪除！`,\n            showConfirmButton: false,\n            timer: 1000\n          });\n        } else if (result.dismiss === Swal.DismissReason.cancel) {\n          return;\n        }\n      });\n    },\n    addCourse() {\n      this.$firestore.courses.add(this.course);\n\n      Swal.fire({\n        type: \"success\",\n        title: `${this.course.title} 新增成功！`,\n        showConfirmButton: false,\n        timer: 1000\n      });\n      this.hideModal();\n    },\n    updateCourse(course) {\n      this.$firestore.courses.doc(course.id).update(this.course);\n      Swal.fire({\n        type: \"success\",\n        title: `${this.course.title} 編輯成功！`,\n        showConfirmButton: false,\n        timer: 1000\n      });\n      this.hideModal();\n    },\n    addTags() {\n      if (this.tag) {\n        this.course.tags.push(this.tag);\n      }\n      this.tag = \"\";\n    },\n    deleteTag(key) {\n      this.course.tags.splice(key, 1);\n    },\n\n    uploadImage(e) {\n      let file = e.target.files[0];\n      var storageRef = firebase.storage().ref(\"courses\" + file.name);\n      storageRef.put(file);\n      console.log(e.target.files[0]);\n    },\n    reset() {\n      // Object.assign(this.$data.course, initialState());\n      this.course = {\n        categorySelected: null,\n        coach: null,\n        details: null,\n        imageUrl: null,\n        intro: \"\",\n        time: null,\n        week: null,\n        originPrice: null,\n        price: null,\n        quantity: null,\n        remainQuantity: null,\n        title: \"\",\n        tags: [],\n        discount: false,\n        avgRating: 0\n      };\n\n      this.modalPage = 1;\n    },\n\n    showModal(isNew, course) {\n      this.$modal.show(\"productModal\", {});\n      if (isNew) {\n        this.modal = \"新增課程\";\n        this.reset();\n      } else {\n        this.modal = \"編輯課程\";\n        this.course = course;\n      }\n    },\n    hideModal() {\n      this.$modal.hide(\"productModal\");\n      this.reset();\n    }\n  }\n};\n</script>\n\n<style>\n#editor {\n  height: 250px;\n}\n</style>"]}]}